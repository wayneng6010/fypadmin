(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{17:function(e,t,a){},188:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAG7AAABuwE67OPiAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAcVQTFRF/////wAAgICAqlVVv0BAzDMzqlVVqjlVs01NuUZGqkBAu0REuEdHsUNOtUBKsUVOsD5Gs0RNtUJKtkJJsUBHtUNKsUFIs0BNtD5LtEBLsUNItUBKs0JMskBJsz9MtEJLsUFJskFJs0BMtD9LtEBLsj9Js0FItEFLskBKs0BJtEFLskFKskFKtEBLsj9Ks0FJskBKsz9KskBLtD9JskFLs0BKs0BJtD9Ls0BKskBLs0FJtEBLtD9Js0BKs0BKs0FKs0BKtEBJs0BLsz9KskBJs0BKsz9Ks0BLs0FLs0FLsz9Ls0FKskBKsz9KtEFKs0BJtD9Ks0BKs0BJtEBKsz9Js0BKs0BKs0BKskBKs0BKsj9Ks0BLsz9KskBKsz9Js0BKsz9Ks0BKs0BKs0BLtD9Ks0BKs0BKs0BKs0BKtEBKs0BKs0BKs0BKs0BKsz9Ks0BKs0BJsz9Ks0BKs0BKs0BKsz9Ks0BLs0BKs0BKs0BKsz9Ks0BKs0BKsz9Ks0BKs0BKtUNNtURNtkROtkZPuUpTu09XwlpixmJox2NqzGtxzm900nd71Ht+24aI24eJ3IeK3YmM5pma7qem76mo8Kuq8a2s9LKwOW574AAAAH90Uk5TAAECAwQFBgkKCwwPEhcYGh0eHyMkJicoKSwuNDY4OTo7P0BBRElKS0xQUlNWXF1eYGFjaWprbG1vdHZ3fX+DhoeLjI2PkJGTlpqdnqOlpqeprK6wsbKztLfAwcPJy83P0dLT1NXY2tze3+Dm5+jp6+zt7u/w8fP29/j5+/z9/k+gHm8AAANESURBVFjDrZf5Q0xRFMePYiKSChFaFGEsUdlSCpUsI1tRWVJSMk1ZJgzzmRkqSdLI/Xv9cN975k2zmHl9f7v3ne+57yz33HNEkiCvtqm9u2/E7x/p625vqs2TjFBU3zuNDdO99UX/y3adHiQhBk+7/oOec2KMpBg7kZOOf3jIFJ70tDS6K0tKKt2NLZ5Jc3focEp6Yb8h96y1Mtf2XxUXTbv6C5Pz944DEPTsTPR1+43PAIzvTcY//gGAnrJkArvvA/DheGLvtQEwUJHKxvIBANoS+HL9PQC60kTK1QXA3dxVX64BBBpsexuK9h1xlxfbdTYEAC7H85sBfPv/beRWXXkR1H4PjnZUx5y43wdQZ+cfA3i93VoXdE7aU2iqs8D6WOIDPtp8te0dEDxkLvOb/auz0N+cb/1DAJiIvRsPAFrNVY3XJIVnZmdnwubKW2P5AWBgncWvA3homtkYACA0txhVSimlootzIQACjSajC+CoudrkA15tNcJ5FYDIwoqKwcpCBICr641oDgDPzSPPAZ+qjIXmz0dVHKLzWoMhVgFw0qg9XuCa+f8AoSWVAEshANOKHuClzpCzAHsM/wWAr8sqIZa/AgHDk2VB4IyIiAwCj4z4eYFQEr5Sy2HAa0TTAwyKiJQCnIrJxyWVFL8AmrXsToAiEbkAvNmo888PzKsU+A74jZx8BtSLyFOgQ291ApFoKgW/vwCdWroV6BXZHAR26fszBSyolPgBTOn4VwLTeVINvNUqq4HQSmoFfyJAtT5vEqiVc8ATraADmFNp8O2fxR6gSW4Bd/TGKLCYTsFPYFTLtwDt0g9c0vkdBKLpFESBoMvK2m4ZttKzGAirtAgDxSIi4gb6ZBw4qCsuMJNewQxQboVhRN4DpZbC2fQKZgG3Lm2A37mCceCAExOGgQYnTuwH2pyE8RZw20kinQceO0nlGuC1k8u0BfiU4+A6y0PLpuwKihTevL/DfFKzKmmrHvlMi2ossirrNmT1sNiQzdNmRxaPa1y3lsXzHm9Fxg3GKk9m3OLEI/MmS0SkqufKtqzbPBFxTThqNEUKAs5aXZHrDpttx+2+84FjDUYe50OX87FvDQZP56PvGgzfmY3/fwEcHneQqn+fZQAAAABJRU5ErkJggg=="},206:function(e,t,a){e.exports=a(450)},211:function(e,t,a){},263:function(e,t){},265:function(e,t){},276:function(e,t){},278:function(e,t){},305:function(e,t){},307:function(e,t){},308:function(e,t){},314:function(e,t){},316:function(e,t){},334:function(e,t){},336:function(e,t){},348:function(e,t){},351:function(e,t){},450:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(22),o=a.n(c),s=(a(211),a(2)),l=a.n(s),i=a(3),u=a(9),d=a(10),_=a(12),m=a(11),p=(a(17),a(14)),h=a.n(p),f=a(7),v=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getLoginDetails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){"undefined"==t[0].last_login&&(t[0].last_login="None"),t[0].last_login=t[0].last_login.replace("T"," ").substring(0,t[0].last_login.indexOf(".")-3),e.setState({login_name:t[0].fname,last_login:t[0].last_login,role:t[0].role})})).catch((function(e){}));case 2:case"end":return t.stop()}}),t)}))),e.state={login_name:null,last_login:null,role:0},e.startup(),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e,t=document.getElementsByClassName("dropdown-btn");for(e=0;e<t.length;e++)t[e].addEventListener("click",(function(){this.classList.toggle("active");var e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"}))}},{key:"render",value:function(){var e=this.state,t=e.role;e.verify_role;return r.a.createElement("div",{class:""},r.a.createElement("div",{class:"sidenav"},r.a.createElement("p",{class:"sidenav_title"},"COVID-19 CTS"),r.a.createElement("div",{class:"admin_outer"},r.a.createElement("p",null,"Admin Panel")),r.a.createElement("div",{class:"mx-0"},r.a.createElement(f.b,{to:{pathname:"/dashboard"}},r.a.createElement("a",{class:"p-0 m-0"},"Dashboard"))),r.a.createElement("button",{class:"dropdown-btn py-2"},"Casual Contacts",r.a.createElement("i",{class:"fa fa-caret-down mr-2 mt-1"})),r.a.createElement("div",{class:"dropdown-container"},r.a.createElement(f.b,{to:{pathname:"/search_casual_contacts"}},r.a.createElement("a",{class:""},"Add Casual Contacts")),r.a.createElement(f.b,{to:{pathname:"/view_casual_contacts"}},r.a.createElement("a",{class:""},"Manage Casual Contacts"))),r.a.createElement("button",{class:"dropdown-btn py-2"},"Hotspots",r.a.createElement("i",{class:"fa fa-caret-down mr-2 mt-1"})),r.a.createElement("div",{class:"dropdown-container"},r.a.createElement(f.b,{to:{pathname:"/add_hotspot"}},r.a.createElement("a",{class:""},"Add New Hotspot")),r.a.createElement(f.b,{to:{pathname:"/view_hotspots"}},r.a.createElement("a",{class:""},"Manage Existing Hotspots")),r.a.createElement(f.b,{to:{pathname:"/view_hotspots_manual_add"}},r.a.createElement("a",{class:""},"Manage Added Hotspots"))),r.a.createElement("div",{class:"mx-0"},r.a.createElement(f.b,{to:{pathname:"/send_batch_email"}},r.a.createElement("a",{class:"p-0 m-0"},"Send Batch Email"))),r.a.createElement("div",{class:"mx-0"},r.a.createElement(f.b,{to:{pathname:"/health_risk_assessment_analytics"}},r.a.createElement("a",{class:"p-0 m-0"},"Health Risk Assessment Analytics"))),r.a.createElement("div",{class:0==t?"d-none":""},r.a.createElement("button",{class:"dropdown-btn py-2"},"Staff",r.a.createElement("i",{class:"fa fa-caret-down mr-2 mt-1"})),r.a.createElement("div",{class:"dropdown-container"},r.a.createElement(f.b,{to:{pathname:"/add_staff"}},r.a.createElement("a",{class:""},"Add New Staff")),r.a.createElement(f.b,{to:{pathname:"/manage_staff"}},r.a.createElement("a",{class:""},"Manage Staff")))),r.a.createElement("div",{class:"mx-0"},r.a.createElement(f.b,{to:{pathname:"/manage_profile"}},r.a.createElement("a",{class:"p-0 m-0"},"Profile"))),r.a.createElement("div",{class:"mx-0 logout_outer"},r.a.createElement(f.b,{to:{pathname:"/logout"}},r.a.createElement("a",{class:"p-0 m-0"},"Logout")))))}}]),a}(n.Component);n.Component,Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(233);var E=a(19),g=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?(e.setState({verify_token:!1}),window.location.href="/dashboard"):"failed_first_login"===t&&e.setState({verify_token:!0})})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.handleSubmit=function(){var t=Object(i.a)(l.a.mark((function t(a){var n,r,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n=e.refs.old_psw.value,r=e.refs.new_psw.value,c=e.refs.con_new_psw.value,r===c){t.next=5;break}return alert("New password does not match"),t.abrupt("return");case 5:if(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z]{8,}$/.test(r)){t.next=8;break}return alert("New password must contain at least 8 characters with combination of number, uppercase and lowercase character"),t.abrupt("return");case 8:return t.next=10,fetch("/change_psw_first_login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{old_psw:n,new_psw:r}})}).then((function(e){return e.json()})).then((function(e){e?(alert("Password changed successful"),window.location.href="/"):alert("Current password is incorrect or new password is same as current password")})).catch((function(e){alert("Error: "+e)}));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={verify_token:!1},e.startup(),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return this.state.verify_token?r.a.createElement("div",{class:""},r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"First Login - Change Password")),r.a.createElement("div",{class:"page_content_first_login"},r.a.createElement("h2",{class:"text-center"},"First Login - Change Password"),r.a.createElement("p",{class:"text-center lead mt-3"},"You have to change password in order to activate your account")),r.a.createElement("div",{class:"mt-5 d-flex justify-content-center align-items-center change_psw_first_login"},r.a.createElement("form",{name:"trace_casual_contacts_form",method:"post",id:"trace_casual_contacts_form",class:"add_staff_form",onSubmit:this.handleSubmit},r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"old_psw"},"Current Password")),r.a.createElement("input",{placeholder:"Current Password",type:"password",className:"form-control",name:"old_psw",id:"old_psw",ref:"old_psw",required:!0})),r.a.createElement("br",null),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"new_psw"},"New Password")),r.a.createElement("input",{placeholder:"New Password",type:"password",className:"form-control",name:"new_psw",id:"new_psw",ref:"new_psw",required:!0})),r.a.createElement("br",null),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"con_new_psw"},"Confirm New Password")),r.a.createElement("input",{placeholder:"Confirm New Password",type:"password",className:"form-control",name:"con_new_psw",id:"con_new_psw",ref:"con_new_psw",required:!0})),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{class:"d-flex justify-content-center align-items-center"},r.a.createElement("input",{id:"search_submit_btn",class:"btn btn-success col-sm-6",type:"submit",value:"Change Password"}))))):r.a.createElement("div",null)}}]),a}(n.Component),b=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).startup=Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.handleSubmit=function(){var t=Object(i.a)(l.a.mark((function t(a){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),n=e.refs.email.value,r=e.refs.psw.value,t.next=4,fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{email:n,psw:r}})}).then((function(e){return e.text()})).then((function(e){"success_first_login"==e?window.location.href="/change_password_first_login":"success"==e?window.location.href="/dashboard":"failed"==e?alert("Email or password is incorrect"):"failed_expired"==e?alert("This account is expired due to not activate within 3 days. Please contact the system administrator on this."):alert("Error occured while login")})).catch((function(e){alert("Error: "+e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{class:"login_outer"},r.a.createElement("div",{class:"login_form_outer d-flex justify-content-center align-items-center"},r.a.createElement("div",null,r.a.createElement("h3",{class:"login_title text-center"},"COVID-19 Contact Tracing System"),r.a.createElement("div",{className:"login_form_outer_inner"},r.a.createElement("h3",{class:"text-center"},"Staff Login"),r.a.createElement("br",null),r.a.createElement("div",{class:"login_form_inner"},r.a.createElement("form",{name:"login_form",method:"post",id:"login_form",onSubmit:this.handleSubmit},r.a.createElement("input",{placeholder:"Email",type:"email",className:"form-control",name:"email",ref:"email",required:!0}),r.a.createElement("br",null),r.a.createElement("input",{placeholder:"Password",type:"password",className:"form-control",name:"psw",ref:"psw",required:!0}),r.a.createElement("br",null),r.a.createElement("input",{id:"search_submit_btn",class:"btn btn-success w-100",type:"submit",value:"Login"}))),r.a.createElement("br",null),r.a.createElement("p",{class:"px-5 text-center"},"This system is only accessible by medical teams of",r.a.createElement("br",null),r.a.createElement("b",null,r.a.createElement("i",null,"Ministry of Health Malaysia")))))))}}]),a}(n.Component),w=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).componentDidMount=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getLoginDetails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){"undefined"==t[0].last_login&&(t[0].last_login="None"),t[0].last_login=t[0].last_login.replace("T"," ").substring(0,t[0].last_login.indexOf(".")-3),e.setState({login_name:t[0].fname,last_login:t[0].last_login})})).catch((function(e){}));case 2:return t.next=4,fetch("/getDashboardData",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){e.setState({dashboard_data:t})})).catch((function(e){}));case 4:case"end":return t.stop()}}),t)}))),e.startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.state={verify_token:!1,login_name:null,last_login:null,dashboard_data:null},e.startup(),e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=e.verify_token,a=e.login_name,n=e.last_login,c=e.dashboard_data;return r.a.createElement("div",null,1==t?r.a.createElement("div",null,r.a.createElement(v,null),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"row"},r.a.createElement("div",{class:"col-sm-2"}),r.a.createElement("div",{class:"col-sm-5 text-right page_title"},"Dashboard"),null==a||null==n?r.a.createElement("p",null):r.a.createElement("div",{class:"col-sm-5 text-right page_subtitle"},"Logged in as "+a,r.a.createElement("span",{class:"ml-5 mr-5"},"Last login - "+n)))),r.a.createElement("div",{class:"page_content"},r.a.createElement("h1",null,"Dashboard"),null==c?r.a.createElement("p",null,"Loading..."):r.a.createElement("div",{class:"row my-4 dash_outer"},r.a.createElement("div",{class:"col-sm-2 dash_box dash_0"},r.a.createElement("p",{class:"left_top"},"Confirmed Case"),r.a.createElement("span",{class:"right_bottom"},c[4])),r.a.createElement("div",{class:"col-sm-2 dash_box dash_1"},r.a.createElement("p",{class:"left_top"},"Casual Contact"),r.a.createElement("span",{class:"right_bottom"},c[0])),r.a.createElement("div",{class:"col-sm-2 dash_box dash_2"},r.a.createElement("p",{class:"left_top"},"Hotspot"),r.a.createElement("span",{class:"right_bottom"},c[1])),r.a.createElement("div",{class:"col-sm-2 dash_box dash_3"},r.a.createElement("p",{class:"left_top"},"Health Risk Assessment Respondent"),r.a.createElement("span",{class:"right_bottom"},c[2])),r.a.createElement("div",{class:"col-sm-2 dash_box dash_4"},r.a.createElement("p",{class:"left_top"},"Staff"),r.a.createElement("span",{class:"right_bottom"},c[3]))))):r.a.createElement("div",null))}}]),a}(n.Component),y=a(15),k=(a(24),a(4)),C=a(20),S=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.saveCasualContacts=Object(i.a)(l.a.mark((function t(){var a,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.check_in_time_range_before_hr+" hr "+e.state.check_in_time_range_before_min+" min",n=e.state.check_in_time_range_after_hr+" hr "+e.state.check_in_time_range_after_min+" min",t.next=4,fetch("/savedCasualContactsGroup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirmed_case_ic_num:e.state.confirmed_case_ic_num,confirmed_case_id:e.state.confirmed_case_info._id,confirmed_case_user_type:e.state.confirmed_case_user_type,check_in_day_range:e.state.check_in_day_range,check_in_time_range_before:a,check_in_time_range_after:n,checked_in_premise:e.state.checked_in_premise,casual_contacts_visitors:e.state.casual_contacts_visitors})}).then((function(e){return e.json()})).then((function(e){e?alert("Saved successful"):alert("Error occured while saving the record")})).catch((function(e){alert("Error: "+e)}));case 4:case"end":return t.stop()}}),t)}))),e.search_casual_contacts_visitor=function(){var t=Object(i.a)(l.a.mark((function t(a,n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.state.checked_in_premise,t.next=3,fetch("/search_casual_contacts_visitor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ic_number:a,check_in_timerange:n})}).then((function(e){return e.json()})).then((function(t){e.setState({casual_contacts_visitors:t});var a=0,n=0;r.forEach((function(e){a=0,t.forEach((function(t){t.check_in_record_id==e._id&&(a+=1,n+=1)})),e.casual_contact_counts=a})),e.setState({checked_in_premise:r,ttl_contact_counts:n,loading_confirmed_case_check_in:!1})})).catch((function(e){alert("Error: "+e)}));case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.search_casual_contacts_dependent=function(){var t=Object(i.a)(l.a.mark((function t(a,n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.state.checked_in_premise,t.next=3,fetch("/search_casual_contacts_dependent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ic_number:a,check_in_timerange:n})}).then((function(e){return e.json()})).then((function(t){e.setState({casual_contacts_visitors:t});var a=0,n=0;r.forEach((function(e){a=0,t.forEach((function(t){t.check_in_record_id==e._id&&(a+=1,n+=1)})),e.casual_contact_counts=a})),e.setState({checked_in_premise:r,ttl_contact_counts:n,loading_confirmed_case_check_in:!1})})).catch((function(e){alert("Error: "+e)}));case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.search_check_in_records_dependent=function(){var t=Object(i.a)(l.a.mark((function t(a,n,r,c,o,s){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/search_check_in_records_dependent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ic_number:a,date_from:n.toISOString()})}).then((function(e){return e.json()})).then((function(t){if(0!=t){var n=t,l=0,i=new Array;t.forEach((function(e){var t=new Date(e.date_created);t.setHours(t.getHours()-parseInt(r)),t.setMinutes(t.getMinutes()-parseInt(c));var a=t.toISOString(),u=new Date(e.date_created);u.setHours(u.getHours()+parseInt(o)),u.setMinutes(u.getMinutes()+parseInt(s));var d=u.toISOString();i.push({check_in_record_id:e._id,user_premiseowner:e.user_premiseowner,time_from:a,time_to:d}),n[l].time_check_in=new Date(e.date_created).toISOString().replace("T"," ").substring(0,e.date_created.indexOf(".")-3),n[l].time_from=a.replace("T"," ").substring(0,e.date_created.indexOf(".")-3),n[l].time_to=d.replace("T"," ").substring(0,e.date_created.indexOf(".")-3),l+=1})),e.setState({checked_in_premise:t,ttl_check_ins:l}),e.search_casual_contacts_dependent(a,i)}else e.setState({checked_in_premise:"none"})})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)})));return function(e,a,n,r,c,o){return t.apply(this,arguments)}}(),e.search_confirmed_case_info_dependent=function(){var t=Object(i.a)(l.a.mark((function t(a,n,r,c,o,s){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/search_confirmed_case_info_dependent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ic_number:a})}).then((function(e){return e.json()})).then((function(t){if(0==t)return e.setState({confirmed_case_info:null,confirmed_case_user_type:null,checked_in_premise:null,casual_contacts_visitors:null,ttl_contact_counts:null}),alert("User not found in the database"),void e.setState({loading_confirmed_case_info:!1,loading_confirmed_case_check_in:!1});e.setState({confirmed_case_info:t,confirmed_case_user_type:"Dependent",loading_confirmed_case_info:!1}),e.search_check_in_records_dependent(a,n,r,c,o,s)})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)})));return function(e,a,n,r,c,o){return t.apply(this,arguments)}}(),e.search_check_in_records_visitor=function(){var t=Object(i.a)(l.a.mark((function t(a,n,r,c,o,s){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/search_check_in_records_visitor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ic_number:a,date_from:n.toISOString()})}).then((function(e){return e.json()})).then((function(t){if(0!=t){var n=t,l=new Array,i=0;t.forEach((function(e){var t=new Date(e.date_created);t.setHours(t.getHours()-parseInt(r)),t.setMinutes(t.getMinutes()-parseInt(c));var a=t.toISOString(),u=new Date(e.date_created);u.setHours(u.getHours()+parseInt(o)),u.setMinutes(u.getMinutes()+parseInt(s));var d=u.toISOString();l.push({check_in_record_id:e._id,user_premiseowner:e.user_premiseowner,time_from:a,time_to:d}),n[i].time_check_in=new Date(e.date_created).toISOString().replace("T"," ").substring(0,e.date_created.indexOf(".")-3),n[i].time_from=a.replace("T"," ").substring(0,e.date_created.indexOf(".")-3),n[i].time_to=d.replace("T"," ").substring(0,e.date_created.indexOf(".")-3),i+=1})),e.setState({checked_in_premise:t,ttl_check_ins:i}),e.search_casual_contacts_visitor(a,l)}else e.setState({checked_in_premise:"none"})})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)})));return function(e,a,n,r,c,o){return t.apply(this,arguments)}}(),e.handleSubmit=function(){var t=Object(i.a)(l.a.mark((function t(a){var n,r,c,o,s,i,u,d,_,m;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n=e.refs.ic_number.value,r=e.refs.check_in_day_range.value,c=e.refs.check_in_time_range_before_hr.value,o=e.refs.check_in_time_range_before_min.value,s=e.refs.check_in_time_range_after_hr.value,i=e.refs.check_in_time_range_after_min.value,/^[0-9]{6}[-]{1}[0-9]{2}[-]{1}[0-9]{4}$/.test(n)){t.next=6;break}return alert("Invalid IC format. Correct format should be xxxxxx-xx-xxxx"),t.abrupt("return");case 6:if(!(r>20)){t.next=9;break}return alert("Check in day range should be more than 20 days"),t.abrupt("return");case 9:if(!(c>48||s>48)){t.next=12;break}return alert("Time range hour should be more than 48 hours"),t.abrupt("return");case 12:if(!(o>59||i>59)){t.next=15;break}return alert("Time range minute should be more than 48 hours"),t.abrupt("return");case 15:return e.setState({loading_confirmed_case_info:!0,loading_confirmed_case_check_in:!0}),u=new Date,(u=new Date(u.getTime()-6e4*u.getTimezoneOffset())).setUTCHours(0,0,0,0),u.setDate(u.getDate()-r),d=(new Date).toJSON().slice(0,10).replace(/-/g,"/"),(_=new Date).setDate(_.getDate()-r),m=_.toJSON().slice(0,10).replace(/-/g,"/"),e.setState({traceUntilDate:d,traceFromDate:m}),e.setState({confirmed_case_ic_num:n,check_in_day_range:r,check_in_time_range_before_hr:c,check_in_time_range_before_min:o,check_in_time_range_after_hr:s,check_in_time_range_after_min:i}),t.next=28,fetch("/search_confirmed_case_info_visitor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ic_number:n})}).then((function(e){return e.json()})).then((function(t){0==t?e.search_confirmed_case_info_dependent(n,u,c,o,s,i):(e.setState({confirmed_case_info:t,confirmed_case_user_type:"Visitor",loading_confirmed_case_info:!1}),e.search_check_in_records_visitor(n,u,c,o,s,i))})).catch((function(e){alert("Error: "+e)}));case 28:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.view_casual_contacts=function(){var t=Object(i.a)(l.a.mark((function t(a){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new Array,r=0,e.state.casual_contacts_visitors.forEach((function(e){e.check_in_record_id===a&&(n.push(e),r+=1)})),n.forEach((function(e){e.hasOwnProperty("visitor_dependent")?(e.ic_num_merged=e.visitor_dependent.ic_num,e.ic_fname_merged=e.visitor_dependent.ic_fname+" (Dependent)"):(e.ic_num_merged=e.user_visitor.ic_num,e.ic_fname_merged=e.user_visitor.ic_fname),e.date_created_simplified=e.date_created.replace("T"," ").substring(0,e.date_created.indexOf(".")-3)})),e.setState({casual_contacts_this_premise:n,casual_contact_counter:r});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleClose=function(){e.setState({modal_show:!1})},e.handleShow=function(t){e.setState({modal_show:!0}),e.view_casual_contacts(t)},e.handleChange_before_hr=function(t){var a=t.target.value;a>48&&(a=48),a=a.toString().replace(/\D/g,""),e.setState({check_in_time_range_before_hr:a})},e.handleChange_before_min=function(t){var a=t.target.value;a>59&&(a=59),a=a.toString().replace(/\D/g,""),e.setState({check_in_time_range_before_min:a})},e.handleChange_after_hr=function(t){var a=t.target.value;a>48&&(a=48),a=a.toString().replace(/\D/g,""),e.setState({check_in_time_range_after_hr:a})},e.handleChange_after_min=function(t){var a=t.target.value;a>59&&(a=59),a=a.toString().replace(/\D/g,""),e.setState({check_in_time_range_after_min:a})},e.isDisabled=function(t){var a=e.state.casual_contacts_visitors,n=!0;return a.forEach((function(e){e.check_in_record_id==t&&(n=!1)})),n},e.startup(),e.state={confirmed_case_ic_num:null,confirmed_case_info:null,confirmed_case_user_type:null,checked_in_premise:null,casual_contacts_visitors:null,casual_contacts_this_premise:null,modal_show:!1,check_in_day_range:null,check_in_time_range_before_hr:0,check_in_time_range_before_min:30,check_in_time_range_after_hr:24,check_in_time_range_after_min:0,ttl_contact_counts:null,traceUntilDate:null,traceFromDate:null,casual_contact_counter:null,ttl_check_ins:null,loading_confirmed_case_info:!1,loading_confirmed_case_check_in:!1,verify_token:!1},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.checked_in_premise,n=t.casual_contacts_visitors,c=t.casual_contacts_this_premise,o=t.confirmed_case_info,s=t.ttl_contact_counts,l=t.traceUntilDate,i=t.traceFromDate,u=t.casual_contact_counter,d=t.ttl_check_ins,_=t.loading_confirmed_case_check_in,m=t.loading_confirmed_case_info;return t.verify_token?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement(k.a,{size:"lg",show:this.state.modal_show,onHide:this.handleClose},r.a.createElement(k.a.Header,{closeButton:!0},r.a.createElement(k.a.Title,null,"Casual Contacts")),r.a.createElement(k.a.Body,null,null===c?r.a.createElement("p",null):r.a.createElement("div",null,r.a.createElement("h5",{class:"mb-3"},"Number of casual contacts: "+u+" contact(s)"),r.a.createElement(y.a,{data:c,columns:[{Header:"Name",accessor:"ic_fname_merged",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"IC No.",accessor:"ic_num_merged",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Check In Date Time",accessor:"date_created_simplified",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}}],defaultPageSize:5,className:"-striped -highlight"}))),r.a.createElement(k.a.Footer,null,r.a.createElement(C.a,{variant:"secondary",onClick:this.handleClose},"Close"))),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"Trace Casual Contacts")),r.a.createElement("div",{class:"page_content"},r.a.createElement("h2",null,"Search for casual contacts"),r.a.createElement("br",null),r.a.createElement("form",{name:"trace_casual_contacts_form",method:"post",id:"trace_casual_contacts_form",onSubmit:this.handleSubmit},r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"ic_number"},"Confirmed case IC number")),r.a.createElement("input",{placeholder:"e.g. 123456-05-1234",type:"text",className:"form-control",name:"ic_number",id:"ic_number",ref:"ic_number",required:!0})),r.a.createElement("br",null),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"check_in_day_range"},"Day range of confirmed case check in")),r.a.createElement("select",{className:"form-control",name:"check_in_day_range",id:"check_in_day_range",ref:"check_in_day_range"},r.a.createElement("option",{value:"1"},"1 day before"),r.a.createElement("option",{value:"2"},"2 day before"),r.a.createElement("option",{value:"3"},"3 day before"),r.a.createElement("option",{value:"4"},"4 day before"),r.a.createElement("option",{value:"5"},"5 day before"),r.a.createElement("option",{value:"6"},"6 day before"),r.a.createElement("option",{value:"7"},"7 day before"),r.a.createElement("option",{value:"8"},"8 day before"),r.a.createElement("option",{value:"9"},"9 day before"),r.a.createElement("option",{value:"10"},"10 day before"),r.a.createElement("option",{value:"11"},"11 day before"),r.a.createElement("option",{value:"12"},"12 day before"),r.a.createElement("option",{value:"13"},"13 day before"),r.a.createElement("option",{value:"14",selected:!0},"14 day before"),r.a.createElement("option",{value:"15"},"15 day before"),r.a.createElement("option",{value:"16"},"16 day before"),r.a.createElement("option",{value:"17"},"17 day before"),r.a.createElement("option",{value:"18"},"18 day before"),r.a.createElement("option",{value:"19"},"19 day before"),r.a.createElement("option",{value:"20"},"20 day before"))),r.a.createElement("br",null),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"check_in_time_range_before"},"Time range of casual contacts check in (before)")),r.a.createElement("input",{placeholder:"0",type:"number",min:"0",max:"48",className:"form-control",name:"check_in_time_range_before_hr",id:"check_in_time_range_before_hr",ref:"check_in_time_range_before_hr",value:this.state.check_in_time_range_before_hr,onInput:this.handleChange_before_hr.bind(this),required:!0}),r.a.createElement("span",null,"Hour"),r.a.createElement("input",{placeholder:"30",type:"number",min:"0",max:"59",className:"form-control",name:"check_in_time_range_before_min",id:"check_in_time_range_before_min",ref:"check_in_time_range_before_min",value:this.state.check_in_time_range_before_min,onInput:this.handleChange_before_min.bind(this),required:!0}),r.a.createElement("span",null,"Minute")),r.a.createElement("br",null),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"check_in_time_range_after"},"Time range of casual contacts check in (after)")),r.a.createElement("input",{placeholder:"24",type:"number",min:"0",max:"48",className:"form-control",name:"check_in_time_range_after_hr",id:"check_in_time_range_after_hr",ref:"check_in_time_range_after_hr",value:this.state.check_in_time_range_after_hr,onInput:this.handleChange_after_hr.bind(this),required:!0}),r.a.createElement("span",null,"Hour"),r.a.createElement("input",{placeholder:"0",type:"number",min:"0",max:"59",className:"form-control",name:"check_in_time_range_after_min",id:"check_in_time_range_after_min",ref:"check_in_time_range_after_min",value:this.state.check_in_time_range_after_min,onInput:this.handleChange_after_min.bind(this),required:!0}),r.a.createElement("span",null,"Minute")),r.a.createElement("br",null),r.a.createElement("input",{id:"search_submit_btn",class:"btn btn-success",type:"submit",value:"Search"})),!0===m?r.a.createElement("p",null,"Loading..."):null===o||null===this.state.confirmed_case_user_type?r.a.createElement("p",null):r.a.createElement("div",{id:"confirmed_case_info_outer"},r.a.createElement("h4",{id:"confirmed_case_info_title"},"Confirmed Case Info"),r.a.createElement("div",{id:"confirmed_case_info"},r.a.createElement("p",null,this.state.confirmed_case_user_type),r.a.createElement("p",null,o.ic_num),r.a.createElement("p",null,o.ic_fname))),"none"===a?r.a.createElement("h5",null,"No check in found"):!0===_?r.a.createElement("p",null,"Loading..."):null===a||null===n||null===s?r.a.createElement("p",null):r.a.createElement("div",{class:"casual_contacts_outer"},r.a.createElement("div",{class:"casual_contacts_trace_info"},r.a.createElement("h5",null,"Traced check ins from "+i+" to "+l),r.a.createElement("h5",null,"Total Check Ins: "+d+" check in(s)"),r.a.createElement("h5",null,"Total Number of Casual Contacts: "+s+" contact(s)")),r.a.createElement("br",null),r.a.createElement(y.a,{data:a,columns:[{Header:"Premise Name",accessor:"user_premiseowner.premise_name",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Check In Time",accessor:"time_check_in",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Time Range (From)",accessor:"time_from",Cell:function(e){return r.a.createElement("div",{class:"table_column_grey"},e.value)}},{Header:"Time Range (To)",accessor:"time_to",Cell:function(e){return r.a.createElement("div",{class:"table_column_grey"},e.value)}},{Header:"Number of Contacts",accessor:"casual_contact_counts",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value+" contact(s)")}},{Header:"View Casual Contacts",accessor:"_id",Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"btn btn-secondary",variant:"secondary",disabled:e.isDisabled(a),onClick:function(){e.handleShow(a)}},"View"))}}],defaultPageSize:5,className:"-striped -highlight"}),r.a.createElement("br",null),r.a.createElement("button",{class:"btn btn-primary",id:"long_btn",onClick:function(){e.saveCasualContacts()}},"Save")))):r.a.createElement("div",null)}}]),a}(n.Component),O=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).verifyToken=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.getCheckInCount=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getCheckInCount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({groupRecord:a})}).then((function(e){return e.json()})).then((function(t){t.sort((function(e,t){return new Date(e.date_created)-new Date(t.date_created)})),e.setState({records_group:t})})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getSavedCasualContactsGroups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){var a=t;a.forEach((function(e){e.hasOwnProperty("confirmed_case_visitor")?(e.visitor_and_dependent_fname=e.confirmed_case_visitor.ic_fname,e.visitor_and_dependent_ic_num=e.confirmed_case_visitor.ic_num):e.hasOwnProperty("confirmed_case_dependent")&&(e.visitor_and_dependent_fname=e.confirmed_case_dependent.ic_fname+" (Dependent)",e.visitor_and_dependent_ic_num=e.confirmed_case_dependent.ic_num),e.date_created=e.date_created.replace("T"," ").substring(0,e.date_created.indexOf(".")-3)})),e.getCheckInCount(a)})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.handleCopyID=function(e){navigator.clipboard.writeText(e)},e.confirm_delete=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Confirm to delete? All of the premise record, casual contact records and hotspots record under this confirmed case will be deleted.")){t.next=5;break}return t.next=3,fetch("/delete_saved_casual_contact_records",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({record_id:a})}).then((function(e){return e.text()})).then((function(t){t?(e.startup(),alert("Record has been deleted successfully")):alert("Error occured while deleting the record")})).catch((function(e){alert("Error: "+e)}));case 3:t.next=6;break;case 5:return t.abrupt("return");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.submitSearch=Object(i.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(a=e.state.search_query)){t.next=4;break}return e.startup(),t.abrupt("return");case 4:if(""!=a.trim()){t.next=7;break}return e.startup(),t.abrupt("return");case 7:return t.next=9,fetch("/search_casual_contact_group",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search_query:a})}).then((function(e){return e.json()})).then((function(t){if(0==t)alert("No record found");else{var a=t;a.forEach((function(e){e.hasOwnProperty("confirmed_case_visitor")?(e.visitor_and_dependent_fname=e.confirmed_case_visitor.ic_fname,e.visitor_and_dependent_ic_num=e.confirmed_case_visitor.ic_num):e.hasOwnProperty("confirmed_case_dependent")&&(e.visitor_and_dependent_fname=e.confirmed_case_dependent.ic_fname+" (Dependent)",e.visitor_and_dependent_ic_num=e.confirmed_case_dependent.ic_num),e.date_created=e.date_created.replace("T"," ").substring(0,e.date_created.indexOf(".")-3)})),e.getCheckInCount(a)}})).catch((function(e){alert("Error: "+e)}));case 9:case"end":return t.stop()}}),t)}))),e.verifyToken(),e.state={records_group:null,search_query:null,verify_token:!1},e.startup(),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.records_group;return t.verify_token?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"View Casual Contacts")),r.a.createElement("div",{class:"page_content"},r.a.createElement("h2",null,"Confirmed Case Record"),r.a.createElement("div",{class:"search_outer"},r.a.createElement("div",{class:"row"},r.a.createElement("input",{type:"text",class:"form-control col-sm-3",id:"search_query",name:"search_query",value:this.state.search_query,onChange:function(t){e.setState({search_query:t.target.value})},placeholder:"Search ID"}),r.a.createElement("button",{class:"btn btn-success col-sm-1 ml-2",onClick:function(){e.submitSearch()},type:"submit"},"Search"))),r.a.createElement("br",null),null==a?r.a.createElement("p",null,"Loading ..."):r.a.createElement(y.a,{data:a,columns:[{Header:"ID",accessor:"_id",width:120,Cell:function(t){return r.a.createElement("div",{class:"table_column"},"..."+t.value.slice(t.value.length-4).toUpperCase()+" ",r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/60/60990.svg",width:17,title:"Copy full ID",class:"copy_id_icon",onClick:function(){e.handleCopyID(t.value)}}))}},{Header:"Confirmed Case Name",accessor:"visitor_and_dependent_fname",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Confirmed Case IC",accessor:"visitor_and_dependent_ic_num",width:200,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Total Premise Checked In",accessor:"check_in_count",width:150,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value+" place(s)")}},{Header:"Total Casual Contact",accessor:"casual_contact_count",width:150,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value+" contact(s)")}},{Header:"Added by",accessor:"staff.fname",width:200,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Date Created",accessor:"date_created",width:200,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"View Checked In Premise",accessor:"_id",width:200,Cell:function(e){var t=e.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement(f.b,{to:{pathname:"/view_confirmed_case_check_ins/".concat(t)}},r.a.createElement("button",{class:"manage_btn register btn btn-success"},"View")))}},{Header:"Delete",accessor:"_id",width:200,Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"manage_btn register btn btn-danger",onClick:function(){e.confirm_delete(a)}},"Delete"))}}],defaultPageSize:10,className:"-striped -highlight"}))):r.a.createElement("div",null)}}]),a}(n.Component),x=a(35),j=a(36),T=function(e){return Object(x.a)(e),r.a.createElement("img",{src:a(75),style:{height:35,width:35}})},A=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).verifyToken=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.getCasualContactCount=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getCasualContactCount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({checkInRecord:a})}).then((function(e){return e.json()})).then((function(t){t.sort((function(e,t){return new Date(e.check_in_record.date_created)-new Date(t.check_in_record.date_created)})),e.setState({check_in_records:t})})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getSelectedSavedCasualContactsGroups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:e.state.group_record_id})}).then((function(e){return e.json()})).then((function(t){if(0==t)alert("No record found");else{var a=t;a.hasOwnProperty("confirmed_case_visitor")?(a.visitor_and_dependent_fname=a.confirmed_case_visitor.ic_fname,a.visitor_and_dependent_ic_num=a.confirmed_case_visitor.ic_num):a.hasOwnProperty("confirmed_case_dependent")&&(a.visitor_and_dependent_fname=a.confirmed_case_dependent.ic_fname+" (Dependent)",a.visitor_and_dependent_ic_num=a.confirmed_case_dependent.ic_num),a.date_created=a.date_created.substring(0,10),e.setState({selected_records_group:a})}})).catch((function(e){alert("Error: "+e)}));case 2:return t.next=4,fetch("/getConfirmedCaseCheckIns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:e.state.group_record_id})}).then((function(e){return e.json()})).then((function(t){0==t?alert("No record found"):(t.forEach((function(e){e.check_in_record.date_created=e.check_in_record.date_created.replace("T"," ").substring(0,e.check_in_record.date_created.indexOf(".")-3),e.user_premiseowner.date_created.replace("T"," ").substring(0,e.user_premiseowner.date_created.indexOf(".")-3)})),e.getCasualContactCount(t))})).catch((function(e){alert("Error: "+e)}));case 4:case"end":return t.stop()}}),t)}))),e.isDisable=function(t){var a=e.state.check_in_records;t=t.split("/")[0];var n=!1;return a.forEach((function(e){e.check_in_record._id==t&&0==e.casual_contact_count&&(n=!0)})),n},e.handleClose=function(){e.setState({modal_show:!1,show_phone_no_qr:!1})},e.handleShow=function(t){e.setState({modal_show:!0,premise_details:t,region:{lat:parseFloat(t.premise_lat),lng:parseFloat(t.premise_lng)},place_lat:parseFloat(t.premise_lat),place_lng:parseFloat(t.premise_lng)})},e.handleCopyID=function(e){navigator.clipboard.writeText(e)},e.submitSearch=Object(i.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(a=e.state.search_query)){t.next=4;break}return e.startup(),t.abrupt("return");case 4:if(""!=a.trim()){t.next=7;break}return e.startup(),t.abrupt("return");case 7:return t.next=9,fetch("/search_confirmed_case_check_in",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:e.state.group_record_id,search_query:a})}).then((function(e){return e.json()})).then((function(t){0==t?alert("No record found"):(t.forEach((function(e){e.check_in_record.date_created=e.check_in_record.date_created.replace("T"," ").substring(0,e.check_in_record.date_created.indexOf(".")-3),e.user_premiseowner.date_created.replace("T"," ").substring(0,e.user_premiseowner.date_created.indexOf(".")-3)})),e.getCasualContactCount(t))})).catch((function(e){alert("Error: "+e)}));case 9:case"end":return t.stop()}}),t)}))),e.verifyToken(),e.state={group_record_id:null,check_in_records:null,selected_records_group:null,premise_details:null,show_phone_no_qr:!1,search_query:null,verify_token:!1},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.state.group_record_id=this.props.match.params.group_record_id,this.startup()}},{key:"render",value:function(){var e=this,t=this.state,a=t.group_record_id,n=t.check_in_records,c=t.selected_records_group,o=t.premise_details,s=t.region,l=t.place_lat,i=t.place_lng,u=t.show_phone_no_qr;return t.verify_token?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement(k.a,{size:"lg",show:this.state.modal_show,onHide:this.handleClose},r.a.createElement(k.a.Header,{closeButton:!0},r.a.createElement(k.a.Title,null,"Contact Details")),r.a.createElement(k.a.Body,null,null===o?r.a.createElement("p",null):r.a.createElement("div",null,null===o?r.a.createElement("p",null):r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("h5",null,"Premise Details"),r.a.createElement("p",null,"Premise Name: "+o.premise_name),r.a.createElement("p",null,"Premise Address: "+o.premise_address+", "+o.premise_postcode+", "+o.premise_state),r.a.createElement("a",{href:"https://www.google.com/maps/place/?q=place_id:".concat(o.premise_id),target:"_blank"},"View on Google Map"),r.a.createElement("div",{style:{height:"300px",width:"70%"}},r.a.createElement(j.a,{center:s,defaultZoom:16},r.a.createElement(T,{lat:l,lng:i}))),r.a.createElement("hr",null),r.a.createElement("h5",null,"Owner Details"),r.a.createElement("p",null,"Owner's Name: "+o.owner_fname),r.a.createElement("p",null,"Owner's Phone No.: "+o.phone_no+" ",r.a.createElement("span",{class:"show_phone_no_qr",onClick:function(){u?e.setState({show_phone_no_qr:!1}):e.setState({show_phone_no_qr:!0})}},u?"Hide Phone No. QR code":"Show Phone No. QR code")),!1===u?r.a.createElement("p",null):r.a.createElement("div",null,r.a.createElement("img",{width:"150",src:"https://qrcode.tec-it.com/API/QRCode?data=tel%3a".concat(o.phone_no)}),r.a.createElement("br",null),r.a.createElement("br",null)),r.a.createElement("p",null,"Owner's Email:"," ",r.a.createElement("a",{href:"mailto:"+o.email,target:"_blank"},o.email)))))),r.a.createElement(k.a.Footer,null,r.a.createElement(C.a,{variant:"secondary",onClick:this.handleClose},"Close"))),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"View Confirmed Case Check Ins")),r.a.createElement("div",{class:"page_content"},r.a.createElement("div",{class:"navigation_breadcrumb"},r.a.createElement("p",null,r.a.createElement(f.b,{target:"_blank",to:{pathname:"/view_casual_contacts"}},r.a.createElement("span",{class:""},"Confirmed Case Record")),r.a.createElement("span",{class:""}," / Confirmed Case Check Ins"))),r.a.createElement("h2",null,"Confirmed Case Check Ins"),r.a.createElement("br",null),null==c?r.a.createElement("p",null,"Loading..."):r.a.createElement("div",null,r.a.createElement("div",{id:"confirmed_case_header_outer"},r.a.createElement("h5",null,"Confirmed Case Info"),r.a.createElement("div",{id:"confirmed_case_header_inner"},r.a.createElement("p",null,c.visitor_and_dependent_fname),r.a.createElement("p",null,c.visitor_and_dependent_ic_num))),r.a.createElement("div",{id:"casual_contact_header_outer"},r.a.createElement("h5",null,"Confirmed Case Record Details"),r.a.createElement("div",{id:"casual_contact_header_inner"},r.a.createElement("p",null,"Filtered check ins of "+c.day_range_check_in+" days before from "+c.date_created),r.a.createElement("p",null,"Traced casual contact check ins of "+c.time_range_check_in_before+" before, "+c.time_range_check_in_after+" after")))),null==a?r.a.createElement("p",null,"Loading..."):r.a.createElement("div",null,r.a.createElement(f.b,{target:"_blank",to:{pathname:"/download_excel_infected_premise/".concat(a)}},r.a.createElement("button",{class:"manage_btn register btn btn-success"},"Download Excel File"))),r.a.createElement("div",{class:"search_outer"},r.a.createElement("div",{class:"row"},r.a.createElement("input",{type:"text",class:"form-control col-sm-3",id:"search_query",name:"search_query",value:this.state.search_query,onChange:function(t){e.setState({search_query:t.target.value})},placeholder:"Search ID / Premise Name / Premise State"}),r.a.createElement("button",{class:"btn btn-success col-sm-1 ml-2",onClick:function(){e.submitSearch()},type:"submit"},"Search"))),r.a.createElement("br",null),null==n?r.a.createElement("p",null,"Loading..."):r.a.createElement(y.a,{data:n,columns:[{Header:"ID",accessor:"_id",width:120,Cell:function(t){return r.a.createElement("div",{class:"table_column"},"..."+t.value.slice(t.value.length-4).toUpperCase()+" ",r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/60/60990.svg",width:17,title:"Copy full ID",class:"copy_id_icon",onClick:function(){e.handleCopyID(t.value)}}))}},{Header:"Check In Premise",accessor:"user_premiseowner.premise_name",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Premise State",accessor:"user_premiseowner.premise_state",width:170,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Total Casual Contact",accessor:"casual_contact_count",width:150,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value+" person(s)")}},{Header:"Check In Entry Point",accessor:"check_in_record.premise_qr_code.entry_point",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Check In Date",accessor:"check_in_record.date_created",width:200,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Premise Details",accessor:"user_premiseowner",width:250,Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"btn btn-secondary",variant:"secondary",onClick:function(){e.handleShow(a)}},"View Premise Details"))}},{Header:"View Casual Contacts",id:"id",width:250,accessor:function(e){return"".concat(e.check_in_record._id)+"/"+"".concat(e.saved_casual_contacts_group)},Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement(f.b,{to:{pathname:"/view_casual_contact_check_ins/".concat(a)}},r.a.createElement("button",{class:"manage_btn register btn btn-success",disabled:e.isDisable(a)},"View Casual Contacts")))}}],defaultPageSize:10,className:"-striped -highlight"}),r.a.createElement("br",null))):r.a.createElement("div",null)}}]),a}(n.Component),N=function(e){return Object(x.a)(e),r.a.createElement("img",{src:a(75),style:{height:35,width:35}})},P=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).verifyToken=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getSelectedSavedCasualContactsGroups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:e.state.check_in_group_id})}).then((function(e){return e.json()})).then((function(t){var a=t;a.hasOwnProperty("confirmed_case_visitor")?(a.visitor_and_dependent_fname=a.confirmed_case_visitor.ic_fname,a.visitor_and_dependent_ic_num=a.confirmed_case_visitor.ic_num):a.hasOwnProperty("confirmed_case_dependent")&&(a.visitor_and_dependent_fname=a.confirmed_case_dependent.ic_fname+" (Dependent)",a.visitor_and_dependent_ic_num=a.confirmed_case_dependent.ic_num),a.date_created=a.date_created.replace("T"," ").substring(0,a.date_created.indexOf(".")-3),e.setState({selected_records_group:a})})).catch((function(e){alert("Error: "+e)}));case 2:return t.next=4,fetch("/getSelectedConfirmedCaseCheckIns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({check_in_id:e.state.check_in_id,check_in_group_id:e.state.check_in_group_id})}).then((function(e){return e.json()})).then((function(t){t.check_in_record.date_created=t.check_in_record.date_created.replace("T"," ").substring(0,t.check_in_record.date_created.indexOf(".")-3),e.setState({selected_check_in_records:t})})).catch((function(e){alert("Error: "+e)}));case 4:return t.next=6,fetch("/getCasualContactCheckIns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({check_in_id:e.state.check_in_id,check_in_group_id:e.state.check_in_group_id})}).then((function(e){return e.json()})).then((function(t){if(0==t)alert("No record found");else{var a,n,r,c,o,s=t,l=(new Date).getFullYear();s.forEach((function(e){e.hasOwnProperty("visitor_dependent")?(c=e.visitor_dependent.ic_num.slice(e.visitor_dependent.ic_num.length-1),o=c%2==0?"Female":"Male",a=e.visitor_dependent.ic_num.substring(0,2),n=a<parseInt(l.toString().substring(2,4))?2e3+parseInt(a):1900+parseInt(a),r=l-n,e.ic_num_merged=e.visitor_dependent.ic_num,e.role="Dependent",e.ic_fname_merged=e.visitor_dependent.ic_fname,e.contact_info_merged={visitor_fname:e.user_visitor.ic_fname,visitor_ic_num:e.user_visitor.ic_num,visitor_ic_address:e.user_visitor.ic_address,visitor_home_lat:e.user_visitor.home_lat,visitor_home_lng:e.user_visitor.home_lng,visitor_home_id:e.user_visitor.home_id,visitor_phone_no:e.user_visitor.phone_no,visitor_email:e.user_visitor.email,dependent_fname:e.visitor_dependent.ic_fname,dependent_ic_num:e.visitor_dependent.ic_num,dependent_relationship:e.visitor_dependent.relationship,dependent_age:r,dependent_gender:o}):e.hasOwnProperty("user_visitor")&&(c=e.user_visitor.ic_num.slice(e.user_visitor.ic_num.length-1),o=c%2==0?"Female":"Male",a=e.user_visitor.ic_num.substring(0,2),n=a<parseInt(l.toString().substring(2,4))?2e3+parseInt(a):1900+parseInt(a),r=l-n,e.ic_num_merged=e.user_visitor.ic_num,e.role="Visitor",e.ic_fname_merged=e.user_visitor.ic_fname,e.contact_info_merged={visitor_fname:e.user_visitor.ic_fname,visitor_ic_num:e.user_visitor.ic_num,visitor_ic_address:e.user_visitor.ic_address,visitor_home_lat:e.user_visitor.home_lat,visitor_home_lng:e.user_visitor.home_lng,visitor_home_id:e.user_visitor.home_id,visitor_phone_no:e.user_visitor.phone_no,visitor_email:e.user_visitor.email,visitor_age:r,visitor_gender:o}),e.check_in_record.date_created=e.check_in_record.date_created.replace("T"," ").substring(0,e.check_in_record.date_created.indexOf(".")-3)})),s.sort((function(e,t){return new Date(e.check_in_record.date_created)-new Date(t.check_in_record.date_created)})),e.setState({check_in_records:s})}})).catch((function(e){alert("Error: "+e)}));case 6:case"end":return t.stop()}}),t)}))),e.handleCheckContacted=function(e){var t=e.target.value;alert(t+" saved")},e.handleClose=function(){e.setState({modal_show:!1,show_phone_no_qr:!1})},e.handleShow=function(t){e.setState({modal_show:!0,contact_info:t,region:{lat:parseFloat(t.visitor_home_lat),lng:parseFloat(t.visitor_home_lng)},place_lat:parseFloat(t.visitor_home_lat),place_lng:parseFloat(t.visitor_home_lng)})},e.handleCopyID=function(e){navigator.clipboard.writeText(e)},e.submitSearch=Object(i.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(a=e.state.search_query)){t.next=4;break}return e.startup(),t.abrupt("return");case 4:if(""!=a.trim()){t.next=7;break}return e.startup(),t.abrupt("return");case 7:return t.next=9,fetch("/search_casual_contact_check_in",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({check_in_id:e.state.check_in_id,check_in_group_id:e.state.check_in_group_id,search_query:e.state.search_query})}).then((function(e){return e.json()})).then((function(t){if(0==t)alert("No record found");else{var a,n,r,c,o,s=t,l=(new Date).getFullYear();s.forEach((function(e){e.hasOwnProperty("visitor_dependent")?(c=e.visitor_dependent.ic_num.slice(e.visitor_dependent.ic_num.length-1),o=c%2==0?"Female":"Male",a=e.visitor_dependent.ic_num.substring(0,2),n=a<parseInt(l.toString().substring(2,4))?2e3+parseInt(a):1900+parseInt(a),r=l-n,e.ic_num_merged=e.visitor_dependent.ic_num,e.role="Dependent",e.ic_fname_merged=e.visitor_dependent.ic_fname,e.contact_info_merged={visitor_fname:e.user_visitor.ic_fname,visitor_ic_num:e.user_visitor.ic_num,visitor_ic_address:e.user_visitor.ic_address,visitor_home_lat:e.user_visitor.home_lat,visitor_home_lng:e.user_visitor.home_lng,visitor_home_id:e.user_visitor.home_id,visitor_phone_no:e.user_visitor.phone_no,visitor_email:e.user_visitor.email,dependent_fname:e.visitor_dependent.ic_fname,dependent_ic_num:e.visitor_dependent.ic_num,dependent_relationship:e.visitor_dependent.relationship,dependent_age:r,dependent_gender:o}):e.hasOwnProperty("user_visitor")&&(c=e.user_visitor.ic_num.slice(e.user_visitor.ic_num.length-1),o=c%2==0?"Female":"Male",a=e.user_visitor.ic_num.substring(0,2),n=a<parseInt(l.toString().substring(2,4))?2e3+parseInt(a):1900+parseInt(a),r=l-n,e.ic_num_merged=e.user_visitor.ic_num,e.role="Visitor",e.ic_fname_merged=e.user_visitor.ic_fname,e.contact_info_merged={visitor_fname:e.user_visitor.ic_fname,visitor_ic_num:e.user_visitor.ic_num,visitor_ic_address:e.user_visitor.ic_address,visitor_home_lat:e.user_visitor.home_lat,visitor_home_lng:e.user_visitor.home_lng,visitor_home_id:e.user_visitor.home_id,visitor_phone_no:e.user_visitor.phone_no,visitor_email:e.user_visitor.email,visitor_age:r,visitor_gender:o}),e.check_in_record.date_created=e.check_in_record.date_created.replace("T"," ").substring(0,e.check_in_record.date_created.indexOf(".")-3)})),s.sort((function(e,t){return new Date(e.check_in_record.date_created)-new Date(t.check_in_record.date_created)})),e.setState({check_in_records:s})}})).catch((function(e){alert("Error: "+e)}));case 9:case"end":return t.stop()}}),t)}))),e.verifyToken(),e.state={check_in_id:null,check_in_group_id:null,check_in_records:null,contact_info:null,selected_records_group:null,selected_check_in_records:null,show_phone_no_qr:!1,search_query:null,verify_token:!1},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.state.check_in_id=this.props.match.params.check_in_id,this.state.check_in_group_id=this.props.match.params.check_in_group_id,this.startup()}},{key:"render",value:function(){var e=this,t=this.state,a=t.check_in_id,n=t.check_in_group_id,c=t.check_in_records,o=t.contact_info,s=t.selected_check_in_records,l=t.selected_records_group,i=t.show_phone_no_qr,u=t.region,d=t.place_lat,_=t.place_lng;return t.verify_token?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement(k.a,{size:"lg",show:this.state.modal_show,onHide:this.handleClose},r.a.createElement(k.a.Header,{closeButton:!0},r.a.createElement(k.a.Title,null,"Contact Details")),r.a.createElement(k.a.Body,null,null===o?r.a.createElement("p",null):r.a.createElement("div",null,o.hasOwnProperty("dependent_fname")?r.a.createElement("div",null,r.a.createElement("h5",null,"Dependent under"," ",o.visitor_fname+" with IC "+o.visitor_ic_num),r.a.createElement("p",null,"Name of Dependent: "+o.dependent_fname),r.a.createElement("p",null,"IC No. of Dependent: "+o.dependent_ic_num),r.a.createElement("p",null,"Age: "+o.dependent_age),r.a.createElement("p",null,"Gender: "+o.dependent_gender),r.a.createElement("p",null,"Relationship: "+o.dependent_relationship),r.a.createElement("hr",null),r.a.createElement("h5",null,"Contact Information of ",o.visitor_fname)):r.a.createElement("div",null,r.a.createElement("h5",null,"Visitor"),r.a.createElement("p",null,"Name: "+o.visitor_fname),r.a.createElement("p",null,"IC No.: "+o.visitor_ic_num),r.a.createElement("p",null,"Age: "+o.visitor_age),r.a.createElement("p",null,"Gender: "+o.visitor_gender)),r.a.createElement("p",null,"Phone No.: "+o.visitor_phone_no+" ",r.a.createElement("span",{class:"show_phone_no_qr",onClick:function(){i?e.setState({show_phone_no_qr:!1}):e.setState({show_phone_no_qr:!0})}},i?"Hide Phone No. QR code":"Show Phone No. QR code")),!1===i?r.a.createElement("p",null):r.a.createElement("div",null,r.a.createElement("img",{width:"150",src:"https://qrcode.tec-it.com/API/QRCode?data=tel%3a".concat(o.visitor_phone_no)}),r.a.createElement("br",null),r.a.createElement("br",null)),r.a.createElement("p",null,"Email:"," ",r.a.createElement("a",{href:"mailto:"+o.visitor_email,target:"_blank"},o.visitor_email)),r.a.createElement("p",null,"Residential Address: "+o.visitor_ic_address),r.a.createElement("a",{href:"https://www.google.com/maps/place/?q=place_id:".concat(o.visitor_home_id),target:"_blank"},"View on Google Map"),r.a.createElement("div",{style:{height:"350px",width:"80%"}},r.a.createElement(j.a,{center:u,defaultZoom:16},r.a.createElement(N,{lat:d,lng:_}))))),r.a.createElement(k.a.Footer,null,r.a.createElement(C.a,{variant:"secondary",onClick:this.handleClose},"Close"))),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"View Casual Contact Check Ins")),r.a.createElement("div",{class:"page_content"},r.a.createElement("div",{class:"navigation_breadcrumb"},r.a.createElement("p",null,r.a.createElement(f.b,{target:"_blank",to:{pathname:"/view_casual_contacts"}},r.a.createElement("span",{class:""},"Confirmed Case Record")),r.a.createElement("span",{class:""}," / "),r.a.createElement(f.b,{target:"_blank",to:{pathname:"/view_confirmed_case_check_ins/".concat(n)}},r.a.createElement("span",{class:""},"Confirmed Case Check Ins")),r.a.createElement("span",{class:""}," / Casual Contact Check Ins"))),r.a.createElement("h2",null,"Casual Contact Check Ins"),r.a.createElement("br",null),null==l?r.a.createElement("p",null,"Loading..."):r.a.createElement("div",null,r.a.createElement("div",{id:"confirmed_case_header_outer"},r.a.createElement("h5",null,"Confirmed Case Info"),r.a.createElement("div",{id:"confirmed_case_header_inner"},r.a.createElement("p",null,l.visitor_and_dependent_fname),r.a.createElement("p",null,l.visitor_and_dependent_ic_num)))),null==s?r.a.createElement("p",null,"Loading..."):r.a.createElement("div",{id:"premise_header_outer"},r.a.createElement("h5",null,"Confirmed Case Checked In Premise Details"),r.a.createElement("div",{id:"premise_header_inner"},r.a.createElement("p",null,s.user_premiseowner.premise_name),r.a.createElement("p",null,"Entry point: "+s.check_in_record.premise_qr_code.entry_point),r.a.createElement("p",null,"Checked in at "+s.check_in_record.date_created))),null==a||null==n?r.a.createElement("p",null,"Loading..."):r.a.createElement("div",null,r.a.createElement(f.b,{target:"_blank",to:{pathname:"/download_excel_casual_contacts/".concat(a,"/").concat(n)}},r.a.createElement("button",{class:"manage_btn register btn btn-success"},"Download Excel File"))),r.a.createElement("div",{class:"search_outer"},r.a.createElement("div",{class:"row"},r.a.createElement("input",{type:"text",class:"form-control col-sm-3",id:"search_query",name:"search_query",value:this.state.search_query,onChange:function(t){e.setState({search_query:t.target.value})},placeholder:"Search ID"}),r.a.createElement("button",{class:"btn btn-success col-sm-1 ml-2",onClick:function(){e.submitSearch()},type:"submit"},"Search"))),r.a.createElement("br",null),null==c?r.a.createElement("p",null,"Loading..."):r.a.createElement(y.a,{data:c,columns:[{Header:"ID",accessor:"_id",width:120,Cell:function(t){return r.a.createElement("div",{class:"table_column"},"..."+t.value.slice(t.value.length-4).toUpperCase()+" ",r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/60/60990.svg",width:17,title:"Copy full ID",class:"copy_id_icon",onClick:function(){e.handleCopyID(t.value)}}))}},{Header:"Name",accessor:"ic_fname_merged",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"IC",accessor:"ic_num_merged",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Role",accessor:"role",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Check In Entry Point",accessor:"check_in_record.premise_qr_code.entry_point",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Check In Date",accessor:"check_in_record.date_created",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Contact Details",accessor:"contact_info_merged",Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"btn btn-secondary",variant:"secondary",onClick:function(){e.handleShow(a)}},"View Contact Details"))}}],defaultPageSize:10,className:"-striped -highlight"}),r.a.createElement("br",null))):r.a.createElement("div",null)}}]),a}(n.Component),D=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return alert(e.state.group_record_id),t.next=3,fetch("/getSimpCasualContactCheckIns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:e.state.group_record_id})}).then((function(e){return e.json()})).then((function(t){alert(JSON.stringify(t)),e.setState({check_in_records:t})})).catch((function(e){alert("Error: "+e)}));case 3:case"end":return t.stop()}}),t)}))),e.handleCheckContacted=function(e){var t=e.target.value;alert(t+" saved")},e.handleClose=function(){e.setState({modal_show:!1})},e.handleShow=function(t){e.setState({modal_show:!0,contact_info:t})},e.state={check_in_id:null,group_record_id:null,check_in_records:null,contact_info:null},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.state.group_record_id=this.props.match.params.group_record_id,this.startup()}},{key:"render",value:function(){var e=this,t=this.state,a=t.check_in_records,n=t.contact_info;return r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement(k.a,{size:"lg",show:this.state.modal_show,onHide:this.handleClose},r.a.createElement(k.a.Header,{closeButton:!0},r.a.createElement(k.a.Title,null,"Contact Details")),r.a.createElement(k.a.Body,null,null===n?r.a.createElement("p",null):r.a.createElement("div",null,n.hasOwnProperty("dependent_fname")?r.a.createElement("div",null,r.a.createElement("p",null,"Dependent under"," ",n.visitor_fname+" with IC "+n.visitor_ic_num),r.a.createElement("p",null,n.dependent_fname),r.a.createElement("p",null,n.dependent_ic_num)):r.a.createElement("div",null,r.a.createElement("p",null,"Visitor"),r.a.createElement("p",null,n.visitor_fname),r.a.createElement("p",null,n.visitor_ic_num)),r.a.createElement("p",null,n.visitor_phone_no),r.a.createElement("img",{width:"150",src:"https://qrcode.tec-it.com/API/QRCode?data=tel%3a".concat(n.visitor_phone_no)}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("p",null,n.visitor_email),r.a.createElement("p",null,n.visitor_ic_address))),r.a.createElement(k.a.Footer,null,r.a.createElement(C.a,{variant:"secondary",onClick:this.handleClose},"Close"))),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"View Casual Contact Check Ins")),r.a.createElement("div",{class:"page_content"},r.a.createElement("h2",null,"Saved Simplified Casual Contact Check In Record"),null==a?r.a.createElement("p",null):r.a.createElement(y.a,{data:a,columns:[{Header:"Visitor Name",accessor:"user_visitor.ic_fname"},{Header:"Visitor IC",accessor:"user_visitor.ic_num"},{Header:"Dependent Name",accessor:"visitor_dependent.ic_fname"},{Header:"Dependent IC",accessor:"visitor_dependent.ic_num"},{Header:"Check In Date",accessor:"check_in_record.date_created"},{Header:"Contact Details",accessor:"contact_info_merged",Cell:function(t){var a=t.value;return r.a.createElement("div",null,r.a.createElement("button",{class:"btn btn-secondary",variant:"secondary",onClick:function(){e.handleShow(a)}},"View Contact Details"))}}],defaultPageSize:5,className:"-striped -highlight"})))}}]),a}(n.Component),I=a(42),H=a.n(I),q=H.a.ExcelFile,B=H.a.ExcelFile.ExcelSheet,R=H.a.ExcelFile.ExcelColumn,J=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).verifyToken=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.startup=Object(i.a)(l.a.mark((function t(){var a,n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state,n=a.check_in_id,r=a.group_record_id,t.next=3,fetch("/getSelectedSavedCasualContactsGroups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:r})}).then((function(e){return e.json()})).then((function(t){var a=new Array,n=t;n.hasOwnProperty("confirmed_case_visitor")?a.push({_id:n._id,visitor_and_dependent_fname:n.confirmed_case_visitor.ic_fname,visitor_and_dependent_ic_num:n.confirmed_case_visitor.ic_num}):n.hasOwnProperty("confirmed_case_dependent")&&a.push({_id:n._id,visitor_and_dependent_fname:n.confirmed_case_dependent.ic_fname+" (Dependent)",visitor_and_dependent_ic_num:n.confirmed_case_dependent.ic_num}),e.setState({confirmed_case_details:a})})).catch((function(e){alert("Error: "+e)}));case 3:return t.next=5,fetch("/getSelectedConfirmedCaseCheckIns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({check_in_id:n,check_in_group_id:r})}).then((function(e){return e.json()})).then((function(t){var a=new Array;t.check_in_record.date_created=t.check_in_record.date_created.replace("T"," ").substring(0,t.check_in_record.date_created.indexOf(".")-3),a.push({_id:t._id,premise_name:t.user_premiseowner.premise_name,premise_owner_name:t.user_premiseowner.owner_fname,premise_owner_phone_no:t.user_premiseowner.phone_no,premise_owner_email:t.user_premiseowner.email,premise_owner_state:t.user_premiseowner.premise_state,premise_owner_address:t.user_premiseowner.premise_address+", "+t.user_premiseowner.premise_postcode+" "+t.user_premiseowner.premise_state,confirmed_case_check_in_date_time:t.check_in_record.date_created}),e.setState({selected_check_in_records:a})})).catch((function(e){alert("Error: "+e)}));case 5:return t.next=7,fetch("/getCasualContactCheckIns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({check_in_id:n,check_in_group_id:r})}).then((function(e){return e.json()})).then((function(t){var a=t,n=new Array,r=new Array;a.forEach((function(e){e.check_in_record.date_created=e.check_in_record.date_created.replace("T"," ").substring(0,e.check_in_record.date_created.indexOf(".")-3),e.hasOwnProperty("visitor_dependent")?r.push({_id:e._id,visitor_fname:e.user_visitor.ic_fname,visitor_ic_num:e.user_visitor.ic_num,visitor_ic_address:e.user_visitor.ic_address,visitor_phone_no:e.user_visitor.phone_no,visitor_email:e.user_visitor.email,dependent_fname:e.visitor_dependent.ic_fname,dependent_ic_num:e.visitor_dependent.ic_num,dependent_check_in_date_time:e.check_in_record.date_created}):e.hasOwnProperty("user_visitor")&&n.push({_id:e._id,visitor_fname:e.user_visitor.ic_fname,visitor_ic_num:e.user_visitor.ic_num,visitor_ic_address:e.user_visitor.ic_address,visitor_phone_no:e.user_visitor.phone_no,visitor_email:e.user_visitor.email,visitor_check_in_date_time:e.check_in_record.date_created})})),e.setState({dependent_record:r,visitor_record:n})})).catch((function(e){alert("Error: "+e)}));case 7:case"end":return t.stop()}}),t)}))),e.verifyToken(),e.state={check_in_premises:null,check_in_id:null,group_record_id:null,check_in_records:null,confirmed_case_details:null,selected_check_in_records:null,dependent_record:null,visitor_record:null,verify_token:!1},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.state.check_in_id=this.props.match.params.check_in_id,this.state.group_record_id=this.props.match.params.check_in_group_id,this.startup()}},{key:"render",value:function(){var e=this.state,t=(e.check_in_premises,e.check_in_records,e.confirmed_case_details),a=e.selected_check_in_records,n=e.dependent_record,c=e.visitor_record;if(!e.verify_token)return r.a.createElement("div",null);var o=t,s=a,l=c,i=n;return r.a.createElement("div",null,null==t||null==a||null==n||null==c?r.a.createElement("p",null,"Download will begin shortly ..."):r.a.createElement(q,{hideElement:!0},r.a.createElement(B,{data:o,name:"Confirmed Case"},r.a.createElement(R,{label:"ID",value:"_id"}),r.a.createElement(R,{label:"Confirmed Case Name",value:"visitor_and_dependent_fname"}),r.a.createElement(R,{label:"Confirmed Case IC",value:"visitor_and_dependent_ic_num"})),r.a.createElement(B,{data:s,name:"Premise Checked In"},r.a.createElement(R,{label:"ID",value:"_id"}),r.a.createElement(R,{label:"Premise Name",value:"premise_name"}),r.a.createElement(R,{label:"Owner Name",value:"premise_owner_name"}),r.a.createElement(R,{label:"Owner Phone No.",value:"premise_owner_phone_no"}),r.a.createElement(R,{label:"Owner Email",value:"premise_owner_email"}),r.a.createElement(R,{label:"Premise State",value:"premise_owner_state"}),r.a.createElement(R,{label:"Premise Address",value:"premise_owner_address"}),r.a.createElement(R,{label:"Confirmed Case Check In Time",value:"confirmed_case_check_in_date_time"})),r.a.createElement(B,{data:l,name:"Visitor"},r.a.createElement(R,{label:"ID",value:"_id"}),r.a.createElement(R,{label:"Name",value:"visitor_fname"}),r.a.createElement(R,{label:"IC Number",value:"visitor_ic_num"}),r.a.createElement(R,{label:"Check In Time",value:"visitor_check_in_date_time"}),r.a.createElement(R,{label:"Residential Address",value:"visitor_ic_address"}),r.a.createElement(R,{label:"Phone Number",value:"visitor_phone_no"}),r.a.createElement(R,{label:"Email",value:"visitor_email"})),r.a.createElement(B,{data:i,name:"Dependent"},r.a.createElement(R,{label:"ID",value:"_id"}),r.a.createElement(R,{label:"Dependent Name",value:"dependent_fname"}),r.a.createElement(R,{label:"Dependent IC Number",value:"dependent_ic_num"}),r.a.createElement(R,{label:"Dependent Check In Time",value:"dependent_check_in_date_time"}),r.a.createElement(R,{label:"Dependent Under (Name)",value:"visitor_fname"}),r.a.createElement(R,{label:"Dependent Under (IC Number)",value:"visitor_ic_num"}),r.a.createElement(R,{label:"Dependent Under (Residential Address)",value:"visitor_ic_address"}),r.a.createElement(R,{label:"Dependent Under (Phone Number)",value:"visitor_phone_no"}),r.a.createElement(R,{label:"Dependent Under (Email)",value:"visitor_email"}))))}}]),a}(n.Component),L=H.a.ExcelFile,K=H.a.ExcelFile.ExcelSheet,F=H.a.ExcelFile.ExcelColumn,M=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).verifyToken=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.getCasualContactCount=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getCasualContactCount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({checkInRecord:a})}).then((function(e){return e.json()})).then((function(t){var a=new Array;t.forEach((function(e){a.push({_id:e._id,premise_name:e.user_premiseowner.premise_name,premise_owner_name:e.user_premiseowner.owner_fname,premise_owner_phone_no:e.user_premiseowner.phone_no,premise_owner_email:e.user_premiseowner.email,premise_owner_state:e.user_premiseowner.premise_state,premise_owner_address:e.user_premiseowner.premise_address+", "+e.user_premiseowner.premise_postcode+" "+e.user_premiseowner.premise_state,confirmed_case_check_in_date_time:e.check_in_record.date_created,casual_contact_count:e.casual_contact_count})})),e.setState({infected_premise:a})})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.startup=Object(i.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.group_record_id,t.next=3,fetch("/getSelectedSavedCasualContactsGroups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:a})}).then((function(e){return e.json()})).then((function(t){var a=new Array,n=t;n.hasOwnProperty("confirmed_case_visitor")?a.push({_id:n._id,visitor_and_dependent_fname:n.confirmed_case_visitor.ic_fname,visitor_and_dependent_ic_num:n.confirmed_case_visitor.ic_num}):n.hasOwnProperty("confirmed_case_dependent")&&a.push({_id:n._id,visitor_and_dependent_fname:n.confirmed_case_dependent.ic_fname+" (Dependent)",visitor_and_dependent_ic_num:n.confirmed_case_dependent.ic_num}),e.setState({confirmed_case_details:a})})).catch((function(e){alert("Error: "+e)}));case 3:return t.next=5,fetch("/getConfirmedCaseCheckIns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:a})}).then((function(e){return e.json()})).then((function(t){t.forEach((function(e){e.check_in_record.date_created=e.check_in_record.date_created.replace("T"," ").substring(0,e.check_in_record.date_created.indexOf(".")-3)})),e.getCasualContactCount(t)})).catch((function(e){alert("Error: "+e)}));case 5:case"end":return t.stop()}}),t)}))),e.verifyToken(),e.state={check_in_premises:null,check_in_id:null,group_record_id:null,check_in_records:null,confirmed_case_details:null,selected_check_in_records:null,dependent_record:null,visitor_record:null,infected_premise:null,verify_token:null},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.state.group_record_id=this.props.match.params.check_in_group_id,this.startup()}},{key:"render",value:function(){var e=this.state,t=e.confirmed_case_details,a=e.infected_premise,n=t,c=a;return e.verify_token?r.a.createElement("div",null,null==t||null==a?r.a.createElement("p",null,"Download will begin shortly ..."):r.a.createElement(L,{hideElement:!0},r.a.createElement(K,{data:n,name:"Confirmed Case"},r.a.createElement(F,{label:"ID",value:"_id"}),r.a.createElement(F,{label:"Confirmed Case Name",value:"visitor_and_dependent_fname"}),r.a.createElement(F,{label:"Confirmed Case IC",value:"visitor_and_dependent_ic_num"})),r.a.createElement(K,{data:c,name:"Infected Premise"},r.a.createElement(F,{label:"ID",value:"_id"}),r.a.createElement(F,{label:"Premise Name",value:"premise_name"}),r.a.createElement(F,{label:"Owner Name",value:"premise_owner_name"}),r.a.createElement(F,{label:"Owner Phone No.",value:"premise_owner_phone_no"}),r.a.createElement(F,{label:"Owner Email",value:"premise_owner_email"}),r.a.createElement(F,{label:"Premise State",value:"premise_owner_state"}),r.a.createElement(F,{label:"Premise Address",value:"premise_owner_address"}),r.a.createElement(F,{label:"Confirmed Case Check In Time",value:"confirmed_case_check_in_date_time"}),r.a.createElement(F,{label:"Number of Casual Contact",value:"casual_contact_count"})))):r.a.createElement("div",null)}}]),a}(n.Component),U=function(e){return Object(x.a)(e),r.a.createElement("img",{src:a(75),style:{height:35,width:35}})},V=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.addNewHotspot=Object(i.a)(l.a.mark((function t(){var a,n,r,c,o,s,i,u,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.state,n=a.place_id,r=a.place_lat,c=a.place_lng,o=a.hotspot_place_name,s=a.hotspot_place_address,i=a.hotspot_place_state,u=a.hotspot_description,d=a.hotspot_remark,null!=o&&""!=o&&null!=u&&""!=u&&null!=d&&""!=d&&null!=s&&""!=s&&null!=i&&""!=i){t.next=4;break}return alert("Please fill in every input"),t.abrupt("return");case 4:if(null!=n&&""!=n&&null!=r&&""!=r&&null!=c&&""!=c){t.next=7;break}return alert("Please select a location"),t.abrupt("return");case 7:return t.next=9,fetch("/add_new_hotspot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({place_id:n,place_lat:r.toString(),place_lng:c.toString(),place_name:o,place_address:s,place_state:i,description:u,remark:d})}).then((function(e){return e.text()})).then((function(e){"success"==e?(alert("Added successfully"),window.location.reload()):alert(e)})).catch((function(e){alert("Error: "+e)}));case 9:case"end":return t.stop()}}),t)}))),e.getSearchLocation=function(){var t=Object(i.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="/getSearchLocation?place_id=".concat(a),console.log(n),t.next=4,h.a.get(n).then((function(t){var n=t.data.result.geometry.location.lat,r=t.data.result.geometry.location.lng;e.setState({region:{lat:n,lng:r},place_lat:n,place_lng:r,place_id:a})})).catch((function(e){alert(e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onPressResult=function(){var t=Object(i.a)(l.a.mark((function t(a,n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({search_prediction_selected:!0,search_query:"",place_name:n}),t.next=3,e.getSearchLocation(a);case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.searchLocation=function(){var t=Object(i.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="/searchLocation?search_query=".concat(a),console.log(n),t.next=4,h.a.get(n).then((function(t){e.setState({search_prediction_selected:!1});var a=[];t.data.predictions.forEach((function(e){a.push({place_name:e.description,place_id:e.place_id})})),e.setState({search_prediction:a})})).catch((function(e){alert(e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({search_query:a.target.value}),!(a.target.value.length>10)){t.next=6;break}return t.next=4,e.searchLocation(a.target.value);case 4:t.next=7;break;case 6:e.setState({search_prediction:[]});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.startup(),e.state={search_prediction:null,search_prediction_selected:!0,region:{lat:5.4022499,lng:100.3093698},place_lat:5.4022499,place_lng:100.3093698,place_id:null,place_name:null,search_query:null,hotspot_place_name:null,hotspot_place_state:"KUALA LUMPUR",hotspot_place_address:null,hotspot_description:null,hotspot_remark:null,verify_token:!1},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.search_prediction,n=t.search_prediction_selected,c=t.region,o=t.place_lat,s=t.place_lng,l=t.place_id;t.search_query;return t.verify_token?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"Add New Hotspot")),r.a.createElement("div",{class:"page_content"},r.a.createElement("h2",null,"Add New Hotspot"),r.a.createElement("br",null),r.a.createElement("div",{id:"update_hotspot_details_outer"},r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"place_name"},"Place Name")),r.a.createElement("input",{placeholder:"Place Name",type:"text",className:"form-control",name:"place_name",id:"place_name",ref:"place_name",value:this.state.hotspot_place_name,onChange:function(t){e.setState({hotspot_place_name:t.target.value})},required:!0})),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"place_address"},"Address")),r.a.createElement("input",{placeholder:"Address",type:"text",className:"form-control",name:"place_address",id:"place_address",ref:"place_address",value:this.state.hotspot_place_address,onChange:function(t){e.setState({hotspot_place_address:t.target.value})},required:!0})),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"place_state"},"State")),r.a.createElement("select",{class:"form-control",name:"place_state",id:"place_state",ref:"place_state",value:this.state.hotspot_place_state,onChange:function(t){e.setState({hotspot_place_state:t.target.value})}},r.a.createElement("option",{value:"KUALA LUMPUR"},"KUALA LUMPUR"),r.a.createElement("option",{value:"LABUAN"},"LABUAN"),r.a.createElement("option",{value:"PUTRAJAYA"},"PUTRAJAYA"),r.a.createElement("option",{value:"JOHOR"},"JOHOR"),r.a.createElement("option",{value:"KEDAH"},"KEDAH"),r.a.createElement("option",{value:"KELANTAN"},"KELANTAN"),r.a.createElement("option",{value:"MELAKA"},"MELAKA"),r.a.createElement("option",{value:"NEGERI SEMBILAN"},"NEGERI SEMBILAN"),r.a.createElement("option",{value:"PAHANG"},"PAHANG"),r.a.createElement("option",{value:"PERAK"},"PERAK"),r.a.createElement("option",{value:"PERLIS"},"PERLIS"),r.a.createElement("option",{value:"PULAU PINANG"},"PULAU PINANG"),r.a.createElement("option",{value:"SABAH"},"SABAH"),r.a.createElement("option",{value:"SARAWAK"},"SARAWAK"),r.a.createElement("option",{value:"SELANGOR"},"SELANGOR"),r.a.createElement("option",{value:"TERENGGANU"},"TERENGGANU"))),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"description"},"Description")),r.a.createElement("textarea",{placeholder:"Description",type:"text",rows:3,maxlength:"1000",className:"form-control",name:"description",id:"description",ref:"description",onChange:function(t){e.setState({hotspot_description:t.target.value})},required:!0},this.state.hotspot_description)),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"remark"},"Remark")),r.a.createElement("textarea",{placeholder:"Remark",type:"text",rows:3,maxlength:"1000",className:"form-control",name:"remark",id:"remark",ref:"remark",onChange:function(t){e.setState({hotspot_remark:t.target.value})},required:!0},this.state.hotspot_remark)),r.a.createElement("br",null),r.a.createElement("div",{class:"label_outer_add"},r.a.createElement("label",{for:"search_query"},"Search for location")),r.a.createElement("div",{class:"search_place_outer_add"},r.a.createElement("input",{placeholder:"Search place",type:"text",className:"form-control",name:"search_query",id:"search_query",ref:"search_query",value:this.state.search_query,onChange:function(t){e.handleChange(t)},required:!0}),r.a.createElement("div",{class:n?"predict_dropdown_hidden":"predict_dropdown_show_add"},null===a?r.a.createElement("p",null):a.map((function(t){return r.a.createElement("p",{style:{paddingVertical:10,cursor:"pointer"},key:t.place_id,onClick:function(){return e.onPressResult(t.place_id,t.place_name)}},t.place_name)})))),null==l?r.a.createElement("div",{class:"no_location_selected"}," No location is selected"):r.a.createElement("div",{class:"location_selected"},"Location has been selected ","\n",r.a.createElement("p",{class:"mb-0"},this.state.place_name)),r.a.createElement("br",null),r.a.createElement("div",{style:{height:"500px",width:"750px"}},r.a.createElement(j.a,{center:c,defaultZoom:16},r.a.createElement(U,{lat:o,lng:s}))),r.a.createElement("br",null),r.a.createElement("button",{class:"px-5 py-2 manage_btn register btn btn-success",onClick:function(){return e.addNewHotspot()}},"Add Hotspot"),r.a.createElement("br",null),r.a.createElement("br",null)))):r.a.createElement("div",null)}}]),a}(n.Component),z=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).verifyToken=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.getHotspotCount=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getHotspotCount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({groupRecord:a})}).then((function(e){return e.json()})).then((function(t){e.setState({records_group:t})})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getSavedCasualContactsGroups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){if(0==t)alert("No record found");else{var a=t;a.forEach((function(e){e.hasOwnProperty("confirmed_case_visitor")?(e.visitor_and_dependent_fname=e.confirmed_case_visitor.ic_fname,e.visitor_and_dependent_ic_num=e.confirmed_case_visitor.ic_num):e.hasOwnProperty("confirmed_case_dependent")&&(e.visitor_and_dependent_fname=e.confirmed_case_dependent.ic_fname+" (Dependent)",e.visitor_and_dependent_ic_num=e.confirmed_case_dependent.ic_num),e.date_created=e.date_created.replace("T"," ").substring(0,e.date_created.indexOf(".")-3)})),e.getHotspotCount(a)}})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.isDisable=function(t){var a=e.state.records_group,n=!1;return a.forEach((function(e){e._id==t&&0==e.hotspot_count&&(n=!0)})),n},e.isDisable_1=function(t){var a=e.state.records_group,n=!1;return a.forEach((function(e){e._id==t&&0==e.hotspot_count&&(n=!0)})),n},e.handleCopyID=function(e){navigator.clipboard.writeText(e)},e.confirm_delete=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Confirm to delete? All of the hotspots record under this confirmed case will be deleted.")){t.next=5;break}return t.next=3,fetch("/delete_all_hotspot_record",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({record_id:a})}).then((function(e){return e.text()})).then((function(t){t?(e.startup(),alert("Record has been deleted successfully")):alert("Error occured while deleting the record")})).catch((function(e){alert("Error: "+e)}));case 3:t.next=6;break;case 5:return t.abrupt("return");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.submitSearch=Object(i.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(a=e.state.search_query)){t.next=4;break}return e.startup(),t.abrupt("return");case 4:if(""!=a.trim()){t.next=7;break}return e.startup(),t.abrupt("return");case 7:return t.next=9,fetch("/search_casual_contact_group",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search_query:a})}).then((function(e){return e.json()})).then((function(t){if(0==t)alert("No record found");else{var a=t;a.forEach((function(e){e.hasOwnProperty("confirmed_case_visitor")?(e.visitor_and_dependent_fname=e.confirmed_case_visitor.ic_fname,e.visitor_and_dependent_ic_num=e.confirmed_case_visitor.ic_num):e.hasOwnProperty("confirmed_case_dependent")&&(e.visitor_and_dependent_fname=e.confirmed_case_dependent.ic_fname+" (Dependent)",e.visitor_and_dependent_ic_num=e.confirmed_case_dependent.ic_num),e.date_created=e.date_created.replace("T"," ").substring(0,e.date_created.indexOf(".")-3)})),e.getHotspotCount(a)}})).catch((function(e){alert("Error: "+e)}));case 9:case"end":return t.stop()}}),t)}))),e.verifyToken(),e.state={records_group:null,search_query:null,verify_token:!1},e.startup(),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.records_group;return t.verify_token?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"View Existing Hotspots")),r.a.createElement("div",{class:"page_content"},r.a.createElement("h2",null,"Confirmed Case Record"),r.a.createElement("div",{class:"search_outer"},r.a.createElement("div",{class:"row"},r.a.createElement("input",{type:"text",class:"form-control col-sm-3",id:"search_query",name:"search_query",value:this.state.search_query,onChange:function(t){e.setState({search_query:t.target.value})},placeholder:"Search ID"}),r.a.createElement("button",{class:"btn btn-success col-sm-1 ml-2",onClick:function(){e.submitSearch()},type:"submit"},"Search"))),r.a.createElement("br",null),null==a?r.a.createElement("p",null,"Loading ..."):r.a.createElement(y.a,{data:a,columns:[{Header:"ID",accessor:"_id",width:120,Cell:function(t){return r.a.createElement("div",{class:"table_column"},"..."+t.value.slice(t.value.length-4).toUpperCase()+" ",r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/60/60990.svg",width:17,title:"Copy full ID",class:"copy_id_icon",onClick:function(){e.handleCopyID(t.value)}}))}},{Header:"Confirmed Case Name",accessor:"visitor_and_dependent_fname",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Confirmed Case IC",accessor:"visitor_and_dependent_ic_num",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Total Hotspots",accessor:"hotspot_count",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value+" place(s)")}},{Header:"Date Created",accessor:"date_created",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"View Hotspots",accessor:"_id",Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement(f.b,{to:{pathname:"/view_hotspots_each/".concat(a)}},r.a.createElement("button",{class:"manage_btn register btn btn-success",disabled:e.isDisable(a)},"View")))}},{Header:"Delete",accessor:"_id",Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"manage_btn register btn btn-danger",disabled:e.isDisable_1(a),onClick:function(){e.confirm_delete(a)}},"Delete All"))}}],defaultPageSize:10,className:"-striped -highlight"}))):r.a.createElement("div",null)}}]),a}(n.Component),G=a(50),Q=function(e){return Object(x.a)(e),r.a.createElement("img",{src:a(188),style:{height:35,width:35}})},Z=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).verifyToken=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.getCasualContactCount=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getCasualContactCount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({checkInRecord:a})}).then((function(e){return e.json()})).then((function(t){e.setState({check_in_records:t})})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/getSelectedSavedCasualContactsGroups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:e.state.group_record_id})}).then((function(e){return e.json()})).then((function(t){var a=t;a.hasOwnProperty("confirmed_case_visitor")?(a.visitor_and_dependent_fname=a.confirmed_case_visitor.ic_fname,a.visitor_and_dependent_ic_num=a.confirmed_case_visitor.ic_num):a.hasOwnProperty("confirmed_case_dependent")&&(a.visitor_and_dependent_fname=a.confirmed_case_dependent.ic_fname+" (Dependent)",a.visitor_and_dependent_ic_num=a.confirmed_case_dependent.ic_num),a.date_created=a.date_created.replace("T"," ").substring(0,a.date_created.indexOf(".")-3),e.setState({selected_records_group:a})})).catch((function(e){alert("Error: "+e)}));case 2:return t.next=4,fetch("/getSavedHotspot_premise",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:e.state.group_record_id})}).then((function(e){return e.json()})).then((function(t){Object.keys(t).length?(t.forEach((function(e){e.date_created=e.date_created.replace("T"," ").substring(0,e.date_created.indexOf(".")-3),e.check_in_record.date_created=e.check_in_record.date_created.replace("T"," ").substring(0,e.check_in_record.date_created.indexOf(".")-3),e.hotspotDetailsMerged={record_id:e._id,place_id:e.place_id,place_lat:parseFloat(e.place_lat),place_lng:parseFloat(e.place_lng)}})),e.setState({premise_hotpots_record:t})):e.setState({premise_hotpots_record:"none"})})).catch((function(e){alert("Error: "+e)}));case 4:return t.next=6,fetch("/getSavedHotspot_home",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:e.state.group_record_id})}).then((function(e){return e.json()})).then((function(t){Object.keys(t).length?(t[0].date_created=t[0].date_created.replace("T"," ").substring(0,t[0].date_created.indexOf(".")-3),t[0].hotspotDetailsMerged={record_id:t[0]._id,place_id:t[0].place_id,place_lat:parseFloat(t[0].place_lat),place_lng:parseFloat(t[0].place_lng)},e.setState({home_hotpots_record:t})):e.setState({home_hotpots_record:"none"})})).catch((function(e){alert("Error: "+e)}));case 6:case"end":return t.stop()}}),t)}))),e.isDisable=function(e){return!1},e.handleClose=function(){e.setState({modal_show:!1})},e.handleShow=function(t){e.setState({modal_show:!0,premise_details:t})},e.handleClose_1=function(){e.setState({modal_show_1:!1})},e.handleShow_1=function(t){e.setState({modal_show_1:!0,premise_place:t,region:{lat:t.place_lat,lng:t.place_lng},place_lat:t.place_lat,place_lng:t.place_lng,place_id:t.place_id})},e.saveNewHotspotLocation=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/saveNewHotspotLocation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({record_id:a,place_id:e.state.place_id,place_lat:e.state.place_lat.toString(),place_lng:e.state.place_lng.toString()})}).then((function(e){return e.text()})).then((function(t){"success"==t?(alert("Saved successfully"),e.startup()):alert("Failed to save")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getSearchLocation=function(){var t=Object(i.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="/getSearchLocation?place_id=".concat(a),console.log(n),t.next=4,h.a.get(n).then((function(t){var n=t.data.result.geometry.location.lat,r=t.data.result.geometry.location.lng;e.setState({region:{lat:n,lng:r},place_lat:n,place_lng:r,place_id:a})})).catch((function(e){alert(e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onPressResult=function(){var t=Object(i.a)(l.a.mark((function t(a,n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({search_prediction_selected:!0,search_query:"",place_name:n}),t.next=3,e.getSearchLocation(a);case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.searchLocation=function(){var t=Object(i.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="/searchLocation?search_query=".concat(a),console.log(n),t.next=4,h.a.get(n).then((function(t){e.setState({search_prediction_selected:!1});var a=[];t.data.predictions.forEach((function(e){a.push({place_name:e.description,place_id:e.place_id})})),e.setState({search_prediction:a})})).catch((function(e){alert(e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setState({search_query:a.target.value}),!(a.target.value.length>10)){t.next=6;break}return t.next=4,e.searchLocation(a.target.value);case 4:t.next=7;break;case 6:e.setState({search_prediction:[]});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.confirm_delete=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Confirm to delete?")){t.next=5;break}return t.next=3,fetch("/delete_one_hotspot_record",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({record_id:a})}).then((function(e){return e.text()})).then((function(t){t?(e.startup(),alert("Record has been deleted successfully")):alert("Error occured while deleting the record")})).catch((function(e){alert("Error: "+e)}));case 3:t.next=6;break;case 5:return t.abrupt("return");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.submitSearch=Object(i.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(a=e.state.search_query_1)){t.next=4;break}return e.startup(),t.abrupt("return");case 4:if(""!=a.trim()){t.next=7;break}return e.startup(),t.abrupt("return");case 7:return t.next=9,fetch("/search_saved_hotspot_premise",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_record_id:e.state.group_record_id,search_query:a})}).then((function(e){return e.json()})).then((function(t){Object.keys(t).length?(t.forEach((function(e){e.date_created=e.date_created.replace("T"," ").substring(0,e.date_created.indexOf(".")-3),e.check_in_record.date_created=e.check_in_record.date_created.replace("T"," ").substring(0,e.check_in_record.date_created.indexOf(".")-3),e.hotspotDetailsMerged={record_id:e._id,place_id:e.place_id,place_lat:parseFloat(e.place_lat),place_lng:parseFloat(e.place_lng)}})),e.setState({premise_hotpots_record:t})):e.setState({premise_hotpots_record:"none"})})).catch((function(e){alert("Error: "+e)}));case 9:case"end":return t.stop()}}),t)}))),e.verifyToken(),e.state={group_record_id:null,premise_hotpots_record:null,home_hotpots_record:null,selected_records_group:null,modal_show:!1,modal_show_1:!1,premise_details:null,premise_place:null,search_prediction:null,search_prediction_selected:!0,region:null,place_lat:null,place_lng:null,place_id:null,place_name:null,search_query:null,show_phone_no_qr:!1,verify_token:!1,search_query_1:null},e.handleChange=e.handleChange.bind(Object(G.a)(e)),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.state.group_record_id=this.props.match.params.group_record_id,this.startup()}},{key:"render",value:function(){var e=this,t=this.state,a=t.premise_hotpots_record,n=t.home_hotpots_record,c=t.selected_records_group,o=t.premise_details,s=t.premise_place,l=t.search_prediction,i=t.region,u=t.place_lat,d=t.place_lng,_=(t.place_id,t.search_prediction_selected),m=t.show_phone_no_qr,p=t.verify_token;t.search_query_1;return p?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"View Hotspots")),r.a.createElement("div",{class:"page_content"},r.a.createElement("div",{class:"navigation_breadcrumb"},r.a.createElement("p",null,r.a.createElement(f.b,{target:"_blank",to:{pathname:"/view_hotspots"}},r.a.createElement("span",{class:""},"Confirmed Case Record")),r.a.createElement("span",{class:""}," / Hotspots"))),r.a.createElement("h2",null,"Hotspots"),r.a.createElement(k.a,{size:"lg",show:this.state.modal_show,onHide:this.handleClose},r.a.createElement(k.a.Header,{closeButton:!0},r.a.createElement(k.a.Title,null,"Premise Details")),r.a.createElement(k.a.Body,null,null===o?r.a.createElement("p",null):r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("h5",null,"Premise Details"),r.a.createElement("p",null,"Premise Name: "+o.premise_name),r.a.createElement("p",null,"Premise Address: "+o.premise_address+", "+o.premise_postcode+", "+o.premise_state),r.a.createElement("hr",null),r.a.createElement("h5",null,"Owner Details"),r.a.createElement("p",null,"Owner's Name: "+o.owner_fname),r.a.createElement("p",null,"Owner's Phone No.: "+o.phone_no+" ",r.a.createElement("span",{class:"show_phone_no_qr",onClick:function(){m?e.setState({show_phone_no_qr:!1}):e.setState({show_phone_no_qr:!0})}},m?"Hide Phone No. QR code":"Show Phone No. QR code")),!1===m?r.a.createElement("p",null):r.a.createElement("div",null,r.a.createElement("img",{width:"150",src:"https://qrcode.tec-it.com/API/QRCode?data=tel%3a".concat(o.phone_no)}),r.a.createElement("br",null),r.a.createElement("br",null)),r.a.createElement("p",null,"Owner's Email:"," ",r.a.createElement("a",{href:"mailto:"+o.email,target:"_blank"},o.email))))),r.a.createElement(k.a.Footer,null,r.a.createElement(C.a,{variant:"secondary",onClick:this.handleClose},"Close"))),r.a.createElement(k.a,{size:"lg",show:this.state.modal_show_1,onHide:this.handleClose_1},r.a.createElement(k.a.Header,{closeButton:!0},r.a.createElement(k.a.Title,null,"Hotspot Details")),r.a.createElement(k.a.Body,null,null===s?r.a.createElement("p",null):r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("h5",null,"Search for new location"),r.a.createElement("div",{class:"search_place_outer"},r.a.createElement("input",{placeholder:"Search place",type:"text",className:"form-control",name:"search_query",id:"search_query",ref:"search_query",value:this.state.search_query,onChange:function(t){e.handleChange(t)},required:!0})),r.a.createElement("div",{class:_?"predict_dropdown_hidden":"predict_dropdown_show"},null===l?r.a.createElement("p",null):l.map((function(t){return r.a.createElement("p",{style:{paddingVertical:10,cursor:"pointer"},key:t.place_id,onClick:function(){return e.onPressResult(t.place_id,t.place_name)}},t.place_name)}))),r.a.createElement("br",null),r.a.createElement("div",{style:{height:"500px",width:"100%"}},r.a.createElement(j.a,{center:i,defaultZoom:16},r.a.createElement(Q,{lat:u,lng:d})))))),r.a.createElement(k.a.Footer,null,r.a.createElement(C.a,{variant:"secondary",onClick:this.handleClose_1},"Cancel"),null===s?r.a.createElement("p",null):r.a.createElement(C.a,{variant:"primary",onClick:function(){e.saveNewHotspotLocation(s.record_id)}},"Save Changes"))),r.a.createElement("br",null),null==c?r.a.createElement("p",null):r.a.createElement("div",null,r.a.createElement("div",{id:"confirmed_case_header_outer"},r.a.createElement("h5",null,"Confirmed Case Info"),r.a.createElement("div",{id:"confirmed_case_header_inner"},r.a.createElement("p",null,c.visitor_and_dependent_fname),r.a.createElement("p",null,c.visitor_and_dependent_ic_num)))),r.a.createElement("h4",{class:"mb-3"},r.a.createElement("img",{class:"mb-2 mr-3",src:"https://www.flaticon.com/svg/static/icons/svg/2948/2948176.svg",width:30}),"Residential Location Hotspot"),null==n?r.a.createElement("p",null,"Loading..."):"none"==n?r.a.createElement("p",{class:"no_record"},"No record found"):r.a.createElement(y.a,{data:n,columns:[{Header:"Home Address",accessor:"user_visitor.ic_address",minWidth:400,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"View Hotspot Details",accessor:"hotspotDetailsMerged",Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"manage_btn register btn btn-success",onClick:function(){e.handleShow_1(a)}},"View / Edit"))}},{Header:"Delete",accessor:"_id",Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"manage_btn register btn btn-danger",onClick:function(){e.confirm_delete(a)}},"Delete"))}}],defaultPageSize:1,className:"-striped -highlight"}),r.a.createElement("br",null),r.a.createElement("h4",{class:"mb-3"},r.a.createElement("img",{class:"mb-2 mr-3",src:"https://www.flaticon.com/svg/static/icons/svg/126/126122.svg",width:30}),"Premise Hotspot"),r.a.createElement("div",{class:"search_outer"},r.a.createElement("div",{class:"row"},r.a.createElement("input",{type:"text",class:"form-control col-sm-3",id:"search_query",name:"search_query",value:this.state.search_query_1,onChange:function(t){e.setState({search_query_1:t.target.value})},placeholder:"Search Place Name / State"}),r.a.createElement("button",{class:"btn btn-success col-sm-1 ml-2",onClick:function(){e.submitSearch()},type:"submit"},"Search"))),r.a.createElement("br",null),null==a?r.a.createElement("p",null,"Loading..."):"none"==a?r.a.createElement("p",{class:"no_record"},"No record found"):r.a.createElement(y.a,{data:a,columns:[{Header:"Check In Premise",accessor:"user_premiseowner.premise_name",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"State",accessor:"user_premiseowner.premise_state",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Check In Date",accessor:"check_in_record.date_created",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"View Premise Details",accessor:"user_premiseowner",Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"manage_btn register btn btn-secondary",onClick:function(){e.handleShow(a)}},"View"))}},{Header:"View Hotspot Details",accessor:"hotspotDetailsMerged",Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"manage_btn register btn btn-success",onClick:function(){e.handleShow_1(a)}},"View / Edit"))}},{Header:"Delete",accessor:"_id",Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"manage_btn register btn btn-danger",onClick:function(){e.confirm_delete(a)}},"Delete"))}}],defaultPageSize:10,className:"-striped -highlight"}),r.a.createElement("br",null))):r.a.createElement("div",null)}}]),a}(n.Component);Z.defaultProps={center:{lat:59.95,lng:30.33},zoom:11};var W=Z,Y=a(112),X=function(e){return Object(x.a)(e),r.a.createElement("img",{src:a(188),style:{height:35,width:35}})},$=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e,n;return Object(u.a)(this,a),(n=t.call(this)).verifyToken=Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(e){"failed"===e?(n.setState({verify_token:!1}),window.location.href="/"):"success"===e?n.setState({verify_token:!0}):"failed_first_login"===e&&(n.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return e.stop()}}),e)}))),n.getCasualContactCount=function(){var e=Object(i.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/getCasualContactCount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({checkInRecord:t})}).then((function(e){return e.json()})).then((function(e){n.setState({check_in_records:e})})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.startup=Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/getSavedHotspot_manual_added",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(e){Object.keys(e).length?(e.forEach((function(e){e.date_created=e.date_created.replace("T"," ").substring(0,e.date_created.indexOf(".")-3),e.hotspotDetailsMerged={record_id:e._id,place_id:e.place_id,place_lat:parseFloat(e.place_lat),place_lng:parseFloat(e.place_lng),hotspot_place_name:e.place_name,hotspot_place_address:e.place_address,hotspot_place_state:e.place_state,hotspot_description:e.description,hotspot_remark:e.remark}})),n.setState({home_hotpots_record:e})):n.setState({home_hotpots_record:"none"})})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return e.stop()}}),e)}))),n.isDisable=function(e){return!1},n.handleClose=function(){n.setState({modal_show:!1})},n.handleShow=function(e){n.setState({modal_show:!0,premise_details:e})},n.handleClose_1=function(){n.setState({modal_show_1:!1})},n.handleShow_1=function(e){n.setState({modal_show_1:!0,premise_place:e,region:{lat:e.place_lat,lng:e.place_lng},place_lat:e.place_lat,place_lng:e.place_lng,place_id:e.place_id,hotspot_place_name:e.hotspot_place_name,hotspot_place_address:e.hotspot_place_address,hotspot_place_state:e.hotspot_place_state,hotspot_description:e.hotspot_description,hotspot_remark:e.hotspot_remark})},n.saveNewHotspotLocation=function(){var e=Object(i.a)(l.a.mark((function e(t){var a,r,c,o,s,i,u,d,_;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.state,r=a.place_id,c=a.place_lat,o=a.place_lng,s=a.hotspot_place_name,i=a.hotspot_place_address,u=a.hotspot_place_state,d=a.hotspot_description,_=a.hotspot_remark,null!=s&&""!=s&&null!=d&&""!=d&&null!=_&&""!=_&&null!=i&&""!=i&&null!=u&&""!=u){e.next=4;break}return alert("Please fill in every input"),e.abrupt("return");case 4:return e.next=6,fetch("/saveHotspotDetails_manual_added",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({record_id:t,place_id:r,place_lat:c.toString(),place_lng:o.toString(),place_name:s,place_address:i,place_state:u,description:d,remark:_})}).then((function(e){return e.text()})).then((function(e){"success"==e?(alert("Saved successfully"),n.startup()):alert("Failed to save"),n.handleClose_1()})).catch((function(e){alert("Error: "+e)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getSearchLocation=function(){var e=Object(i.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/getSearchLocation?place_id=".concat(t),console.log(a),e.next=4,h.a.get(a).then((function(e){var a=e.data.result.geometry.location.lat,r=e.data.result.geometry.location.lng;n.setState({region:{lat:a,lng:r},place_lat:a,place_lng:r,place_id:t})})).catch((function(e){alert(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onPressResult=function(){var e=Object(i.a)(l.a.mark((function e(t,a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({search_prediction_selected:!0,search_query:"",place_name:a}),e.next=3,n.getSearchLocation(t);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.searchLocation=function(){var e=Object(i.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/searchLocation?search_query=".concat(t),console.log(a),e.next=4,h.a.get(a).then((function(e){n.setState({search_prediction_selected:!1});var t=[];e.data.predictions.forEach((function(e){t.push({place_name:e.description,place_id:e.place_id})})),n.setState({search_prediction:t})})).catch((function(e){alert(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.confirm_delete=function(){var e=Object(i.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Confirm to delete?")){e.next=5;break}return e.next=3,fetch("/delete_one_hotspot_record",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({record_id:t})}).then((function(e){return e.text()})).then((function(e){e?(n.startup(),alert("Record has been deleted successfully")):alert("Error occured while deleting the record")})).catch((function(e){alert("Error: "+e)}));case 3:e.next=6;break;case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleChange=function(){var e=Object(i.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.setState({search_query:t.target.value}),10!=t.target.value.length){e.next=6;break}return e.next=4,n.searchLocation(t.target.value);case 4:e.next=7;break;case 6:n.setState({search_prediction:[]});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.submitSearch=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=n.state.search_query)){e.next=4;break}return n.startup(),e.abrupt("return");case 4:if(""!=t.trim()){e.next=7;break}return n.startup(),e.abrupt("return");case 7:return e.next=9,fetch("/search_manual_added_hotspot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search_query:t})}).then((function(e){return e.json()})).then((function(e){Object.keys(e).length?(e.forEach((function(e){e.date_created=e.date_created.replace("T"," ").substring(0,e.date_created.indexOf(".")-3),e.hotspotDetailsMerged={record_id:e._id,place_id:e.place_id,place_lat:parseFloat(e.place_lat),place_lng:parseFloat(e.place_lng),hotspot_place_name:e.place_name,hotspot_place_address:e.place_address,hotspot_place_state:e.place_state,hotspot_description:e.description,hotspot_remark:e.remark}})),n.setState({home_hotpots_record:e})):n.setState({home_hotpots_record:"none"})})).catch((function(e){alert("Error: "+e)}));case 9:case"end":return e.stop()}}),e)}))),n.verifyToken(),n.state=(e={premise_hotpots_record:null,home_hotpots_record:null,selected_records_group:null,modal_show:!1,modal_show_1:!1,premise_details:null,premise_place:null,search_prediction:null,search_prediction_selected:!0,region:null,place_lat:null,place_lng:null,place_id:null,search_query:null,hotspot_place_name:null,hotspot_description:null,hotspot_remark:null},Object(Y.a)(e,"search_query",null),Object(Y.a)(e,"verify_token",!1),e),n.handleChange=n.handleChange.bind(Object(G.a)(n)),n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.startup()}},{key:"render",value:function(){var e=this,t=this.state,a=(t.premise_hotpots_record,t.home_hotpots_record),n=t.selected_records_group,c=t.premise_details,o=t.premise_place,s=t.search_prediction,l=t.region,i=t.place_lat,u=t.place_lng,d=t.search_prediction_selected;return t.verify_token?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"View Manual Added Hotspots")),r.a.createElement("div",{class:"page_content"},r.a.createElement("h2",null,"Manual Added Hotspots"),r.a.createElement(k.a,{size:"lg",show:this.state.modal_show,onHide:this.handleClose},r.a.createElement(k.a.Header,{closeButton:!0},r.a.createElement(k.a.Title,null,"Premise Details")),r.a.createElement(k.a.Body,null,null===c?r.a.createElement("p",null):r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("h5",null,"Premise Details"),r.a.createElement("p",null,c.premise_name),r.a.createElement("p",null,c.premise_address+", "+c.premise_postcode+", "+c.premise_state),r.a.createElement("h5",null,"Owner Details"),r.a.createElement("p",null,c.owner_fname),r.a.createElement("p",null,c.phone_no),r.a.createElement("p",null,c.email)))),r.a.createElement(k.a.Footer,null,r.a.createElement(C.a,{variant:"secondary",onClick:this.handleClose},"Close"))),r.a.createElement(k.a,{size:"lg",show:this.state.modal_show_1,onHide:this.handleClose_1},r.a.createElement(k.a.Header,{closeButton:!0},r.a.createElement(k.a.Title,null,"Hotspot Details")),r.a.createElement(k.a.Body,null,null===o?r.a.createElement("p",null):r.a.createElement("div",null,r.a.createElement("div",{id:"update_hotspot_details_outer"},r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"place_name"},"Place Name")),r.a.createElement("input",{placeholder:"Place Name",type:"text",className:"form-control",name:"place_name",id:"place_name",ref:"place_name",value:this.state.hotspot_place_name,onChange:function(t){e.setState({hotspot_place_name:t.target.value})},required:!0})),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"place_address"},"Address")),r.a.createElement("input",{placeholder:"Address",type:"text",className:"form-control",name:"place_address",id:"place_address",ref:"place_address",value:this.state.hotspot_place_address,onChange:function(t){e.setState({hotspot_place_address:t.target.value})},required:!0})),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"place_state"},"State")),r.a.createElement("select",{class:"form-control",name:"place_state",id:"place_state",ref:"place_state",value:this.state.hotspot_place_state,onChange:function(t){e.setState({hotspot_place_state:t.target.value})}},r.a.createElement("option",{value:"KUALA LUMPUR"},"KUALA LUMPUR"),r.a.createElement("option",{value:"LABUAN"},"LABUAN"),r.a.createElement("option",{value:"PUTRAJAYA"},"PUTRAJAYA"),r.a.createElement("option",{value:"JOHOR"},"JOHOR"),r.a.createElement("option",{value:"KEDAH"},"KEDAH"),r.a.createElement("option",{value:"KELANTAN"},"KELANTAN"),r.a.createElement("option",{value:"MELAKA"},"MELAKA"),r.a.createElement("option",{value:"NEGERI SEMBILAN"},"NEGERI SEMBILAN"),r.a.createElement("option",{value:"PAHANG"},"PAHANG"),r.a.createElement("option",{value:"PERAK"},"PERAK"),r.a.createElement("option",{value:"PERLIS"},"PERLIS"),r.a.createElement("option",{value:"PULAU PINANG"},"PULAU PINANG"),r.a.createElement("option",{value:"SABAH"},"SABAH"),r.a.createElement("option",{value:"SARAWAK"},"SARAWAK"),r.a.createElement("option",{value:"SELANGOR"},"SELANGOR"),r.a.createElement("option",{value:"TERENGGANU"},"TERENGGANU"))),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"description"},"Description")),r.a.createElement("textarea",{placeholder:"Description",type:"text",rows:3,maxlength:"1000",className:"form-control",name:"description",id:"description",ref:"description",onChange:function(t){e.setState({hotspot_description:t.target.value})},required:!0},this.state.hotspot_description)),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"remark"},"Remark")),r.a.createElement("textarea",{placeholder:"Remark",type:"text",rows:3,maxlength:"1000",className:"form-control",name:"remark",id:"remark",ref:"remark",onChange:function(t){e.setState({hotspot_remark:t.target.value})},required:!0},this.state.hotspot_remark)),r.a.createElement("br",null),r.a.createElement("h5",null,"Search for new location"),r.a.createElement("div",{class:"search_place_outer"},r.a.createElement("input",{placeholder:"Search place",type:"text",className:"form-control w-100",name:"search_query",id:"search_query",ref:"search_query",value:this.state.search_query,onChange:function(t){e.handleChange(t)},required:!0})),r.a.createElement("div",{class:d?"predict_dropdown_hidden":"predict_dropdown_show"},null===s?r.a.createElement("p",null):s.map((function(t){return r.a.createElement("p",{style:{paddingVertical:10,cursor:"pointer"},key:t.place_id,onClick:function(){return e.onPressResult(t.place_id,t.place_name)}},t.place_name)}))),r.a.createElement("br",null),r.a.createElement("div",{style:{height:"400px",width:"100%"}},r.a.createElement(j.a,{center:l,defaultZoom:16},r.a.createElement(X,{lat:i,lng:u})))))),r.a.createElement(k.a.Footer,null,r.a.createElement(C.a,{variant:"secondary",onClick:this.handleClose_1},"Cancel"),null===o?r.a.createElement("p",null):r.a.createElement(C.a,{variant:"primary",onClick:function(){e.saveNewHotspotLocation(o.record_id)}},"Save Changes"))),r.a.createElement("div",{class:"search_outer"},r.a.createElement("div",{class:"row"},r.a.createElement("input",{type:"text",class:"form-control col-sm-4",id:"search_query",name:"search_query",value:this.state.search_query,onChange:function(t){e.setState({search_query:t.target.value})},placeholder:"Search Place Name / State / Address / Description / Remark"}),r.a.createElement("button",{class:"btn btn-success col-sm-1 ml-2",onClick:function(){e.submitSearch()},type:"submit"},"Search"))),r.a.createElement("br",null),null==n?r.a.createElement("p",null):r.a.createElement("div",null,r.a.createElement("div",{id:"confirmed_case_header_outer"},r.a.createElement("h5",null,"Confirmed Case Info"),r.a.createElement("div",{id:"confirmed_case_header_inner"},r.a.createElement("p",null,n.visitor_and_dependent_fname),r.a.createElement("p",null,n.visitor_and_dependent_ic_num)))),null==a?r.a.createElement("p",null):"none"==a?r.a.createElement("p",{class:"no_record"},"No record found"):r.a.createElement(y.a,{data:a,columns:[{Header:"Place Name",accessor:"place_name",minWidth:200,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"State",accessor:"place_state",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Address",accessor:"place_address",minWidth:300,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Date Created",accessor:"date_created",minWidth:100,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"View Hotspot Details",accessor:"hotspotDetailsMerged",Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"manage_btn register btn btn-success",onClick:function(){e.handleShow_1(a)}},"View / Edit"))}},{Header:"Delete",accessor:"_id",Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column"},r.a.createElement("button",{class:"manage_btn register btn btn-danger",onClick:function(){e.confirm_delete(a)}},"Delete"))}}],defaultPageSize:10,className:"-striped -highlight"}))):r.a.createElement("div",null)}}]),a}(n.Component);$.defaultProps={center:{lat:59.95,lng:30.33},zoom:11};var ee=$,te=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a),(e=t.call(this)).startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.componentDidMount=Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.search_confirmed_case_id=Object(i.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(a=e.state.group_id)&&""!=a){t.next=4;break}return alert("Please fill in the confirmed case record ID"),t.abrupt("return");case 4:return t.next=6,fetch("/search_confirmed_case_by_id",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_id:a})}).then((function(e){return e.json()})).then((function(t){t?(t.hasOwnProperty("confirmed_case_visitor")?(t.visitor_and_dependent_fname=t.confirmed_case_visitor.ic_fname,t.visitor_and_dependent_ic_num=t.confirmed_case_visitor.ic_num):t.hasOwnProperty("confirmed_case_dependent")&&(t.visitor_and_dependent_fname=t.confirmed_case_dependent.ic_fname,t.visitor_and_dependent_ic_num=t.confirmed_case_dependent.ic_num),t.date_created=t.date_created.replace("T"," ").substring(0,t.date_created.indexOf(".")-3),e.setState({confirmed_case_ic_num:t.visitor_and_dependent_ic_num,confirmed_case_name:t.visitor_and_dependent_fname,confirmed_case_date_created:t.date_created,group_id_verified:!0})):(alert("Confirmed case record not found."),e.setState({group_id_verified:!1}))})).catch((function(e){alert("Error: "+e)}));case 6:case"end":return t.stop()}}),t)}))),e.handleSubmit=Object(i.a)(l.a.mark((function t(){var a,n,r,c,o,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.state,n=a.group_id_verified,r=a.group_id,c=a.email_subject,o=a.email_content,s=a.send_to,n){t.next=4;break}return alert("Please confirm the confirmed case record first"),t.abrupt("return");case 4:if(null!=r&&""!=r&&null!=c&&""!=c&&null!=o&&""!=o){t.next=7;break}return alert("Please fill in all the input"),t.abrupt("return");case 7:if(e.setState({sending_mail:!0}),"casual_contact"!=s){t.next=13;break}return t.next=11,fetch("/send_batch_email_casual_contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_id:r,email_subject:c,email_content:o})}).then((function(e){return e.text()})).then((function(t){"success"==t?(alert("Email has been sent to all the casual contacts"),window.location.reload()):"send_email_failed"==t?alert("Email failed to send"):alert(t),e.setState({sending_mail:!1})})).catch((function(e){alert("Error: "+e)}));case 11:t.next=16;break;case 13:if("premise_owner"!=s){t.next=16;break}return t.next=16,fetch("/send_batch_email_premise_owner",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_id:r,email_subject:c,email_content:o})}).then((function(e){return e.text()})).then((function(t){"success"==t?(alert("Email has been sent to all the affected premise owner"),window.location.reload()):"send_email_failed"==t?alert("Email failed to send"):alert(t),e.setState({sending_mail:!1})})).catch((function(e){alert("Error: "+e)}));case 16:case"end":return t.stop()}}),t)}))),e.send_to_onChange=function(){"premise_owner"==e.state.send_to?e.setState({email_content:"Good day,\r\n\r\nSorry to inform that one of the COVID-19 patient have checked in to your premise. Please wait for further instructions. The medical team of Ministry of Health (MOH) Malaysia will contact you soon.\r\n\r\nRegards,\r\nMedical Team from MOH\r\nCOVID-19 Contact Tracing System"}):"casual_contact"==e.state.send_to&&e.setState({email_content:"Good day,\r\n\r\nSorry to inform that you or/and your dependent have been in casual contact with one of the COVID-19 patient. Please avoid close contact with others if possible until you get further instructions. The medical team of Ministry of Health (MOH) Malaysia will contact you soon.\r\n\r\nRegards,\r\nMedical Team from MOH\r\nCOVID-19 Contact Tracing System"})},e.startup();return e.state={sending_mail:!1,confirmed_case_name:null,confirmed_case_ic_num:null,group_id:null,group_id_verified:!1,verify_token:!1,send_to:"premise_owner",email_subject:"Inform about Casual Contact with COVID-19 patient",email_content:"Good day,\r\n\r\nSorry to inform that one of the COVID-19 patient have checked in to your premise. Please wait for further instructions. The medical team of Ministry of Health (MOH) Malaysia will contact you soon.\r\n\r\nRegards,\r\nMedical Team from MOH\r\nCOVID-19 Contact Tracing System"},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.confirmed_case_ic_num,n=t.confirmed_case_name,c=t.confirmed_case_date_created,o=t.sending_mail,s=t.group_id,l=t.email_subject,i=t.email_content,u=t.send_to,d=t.group_id_verified;return t.verify_token?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"Send Batch Email")),r.a.createElement("div",{class:"page_content"},r.a.createElement("h2",null,"Send Batch Email"),r.a.createElement("br",null),r.a.createElement("div",{class:"row mb-3"},r.a.createElement("h5",{class:"col-sm-2"},"Confirmed Case Record ID"),r.a.createElement("input",{placeholder:"e.g. 5f4781ee048dc43e5867d748",type:"text",className:"form-control col-sm-3",name:"group_id",id:"group_id",ref:"group_id",value:s,onChange:function(t){e.setState({group_id:t.target.value})},required:!0}),r.a.createElement("button",{class:"btn btn-secondary col-sm-1 ml-3",onClick:function(){e.search_confirmed_case_id()}},"Confirm")),null==a||null==n||null==c||0==d?r.a.createElement("div",{class:"row mb-3"},r.a.createElement("div",{class:"col-sm-2"}),r.a.createElement("div",{class:"record_no_confirm_batch_mail"},r.a.createElement("h5",null,"Please confirm the Confirmed Case Record"))):r.a.createElement("div",{class:"row mb-3"},r.a.createElement("div",{class:"col-sm-2"}),r.a.createElement("div",{class:"record_confirmed_batch_mail"},r.a.createElement("h5",null,"Confirmed Case Record has been confirmed"),r.a.createElement("p",null,"Confirmed Case Name: "+n),r.a.createElement("p",null,"Confirmed Case IC No.: "+a),r.a.createElement("p",null,"Date created: "+c))),r.a.createElement("div",{class:"row mb-3"},r.a.createElement("h5",{class:"col-sm-2"},"Send To"),r.a.createElement("select",{class:"form-control col-sm-5",name:"place_state",id:"place_state",ref:"place_state",value:this.state.send_to,onChange:function(t){e.state.send_to=t.target.value,e.send_to_onChange()}},r.a.createElement("option",{selected:"premise_owner"==u,value:"premise_owner"},"Premise Owner"),r.a.createElement("option",{selected:"premise_owner"==u,value:"casual_contact"},"Casual Contact"))),r.a.createElement("br",null),r.a.createElement("div",{class:"row mb-3"},r.a.createElement("h5",{class:"col-sm-2"},"Email Subject"),r.a.createElement("input",{placeholder:"Email Subject",type:"text",className:"form-control col-sm-5 email_subject",name:"email_subject",id:"email_subject",ref:"email_subject",value:l,onChange:function(t){e.setState({email_subject:t.target.value})},required:!0})),r.a.createElement("br",null),r.a.createElement("div",{class:"row mb-3"},r.a.createElement("h5",{class:"col-sm-2"},"Email Content"),r.a.createElement("textarea",{rows:11,placeholder:"Email Content",type:"text",className:"form-control col-sm-5",name:"email_content",id:"email_content",ref:"email_content",value:i,onChange:function(t){e.setState({email_content:t.target.value})},required:!0})),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("input",{id:"search_submit_btn",class:"btn btn-success px-5",type:"submit",value:"Send Email",onClick:function(){e.handleSubmit()}}),r.a.createElement("br",null),r.a.createElement("br",null),1==o?r.a.createElement("div",{class:"alert alert-primary w-50",role:"alert"},"Please wait while the mail is being sent."):r.a.createElement("p",null))):r.a.createElement("div",null)}}]),a}(n.Component),ae=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:return t.next=4,fetch("/getLoginDetails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){0==t[0].role?window.location.href="/dashboard":e.setState({verify_role:!0})})).catch((function(e){}));case 4:case"end":return t.stop()}}),t)}))),e.handleClose=function(){e.setState({modal_show:!1})},e.handleShow=function(t){e.setState({modal_show:!0}),e.view_casual_contacts(t)},e.handleSubmit=function(){var t=Object(i.a)(l.a.mark((function t(a){var n,r,c,o,s,i,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n=e.refs.fname.value,r=e.refs.email_address.value,c=e.refs.role.value,null!=n&&""!=n&&null!=r&&""!=r&&null!=c&&""!=c){t.next=5;break}return alert("Please fill in all the input"),t.abrupt("return");case 5:for(e.setState({sending_mail:!0}),10,s="",i=0,u=(o="!@#$^&*abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789").length;i<10;++i)s+=o.charAt(Math.floor(Math.random()*u));return t.next=10,fetch("/add_new_staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fname:n,email_address:r,role:c,random_psw:s})}).then((function(e){return e.text()})).then((function(t){"success"==t?(alert("Email has been sent to the new staff"),window.location.reload()):"email_existed"==t?alert("This email is existed in staff list. Email was not sent."):"send_email_failed"==t?alert("Email failed to send"):alert(t),e.setState({sending_mail:!1})})).catch((function(e){alert("Error: "+e)}));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.startup(),e.state={sending_mail:!1,verify_token:!1,verify_role:!1},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.sending_mail,a=e.verify_token,n=e.verify_role;return a&&n?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"Add New Staff")),r.a.createElement("div",{class:"page_content"},r.a.createElement("h2",null,"Add New Staff"),r.a.createElement("br",null),r.a.createElement("form",{name:"trace_casual_contacts_form",method:"post",id:"trace_casual_contacts_form",class:"add_staff_form",onSubmit:this.handleSubmit},r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"fname"},"Full Name")),r.a.createElement("input",{placeholder:"Full Name",type:"text",className:"form-control",name:"fname",id:"fname",ref:"fname",required:!0})),r.a.createElement("br",null),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"email_address"},"Email Address")),r.a.createElement("input",{placeholder:"Email Address",type:"email",className:"form-control",name:"email_address",id:"email_address",ref:"email_address",required:!0})),r.a.createElement("br",null),r.a.createElement("div",{class:"input_outer"},r.a.createElement("div",{class:"label_outer"},r.a.createElement("label",{for:"role"},"Role")),r.a.createElement("input",{placeholder:"Role",type:"role",className:"form-control",name:"role",id:"role",ref:"role",value:"Staff",disabled:!0,required:!0})),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("input",{id:"search_submit_btn",class:"btn btn-success",type:"submit",value:"Add Staff"})),r.a.createElement("br",null),1==t?r.a.createElement("div",{class:"alert alert-primary w-50",role:"alert"},"Please wait while the mail is being sent."):r.a.createElement("p",null))):r.a.createElement("div",null)}}]),a}(n.Component),ne=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:return t.next=4,fetch("/getLoginDetails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){0==t[0].role?window.location.href="/dashboard":e.setState({verify_role:!0})})).catch((function(e){}));case 4:return t.next=6,fetch("/get_all_staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){t.forEach((function(e){e.hasOwnProperty("phone_no")||(e.phone_no="-"),1==e.role?e.role="Admin":0==e.role&&(e.role="Staff"),1==e.first_login?e.first_login="No":0==e.first_login&&(e.first_login="Yes"),e.date_created=e.date_created.replace("T"," ").substring(0,e.date_created.indexOf(".")-3)})),e.setState({staff_list:t})})).catch((function(e){alert("Error: "+e)}));case 6:case"end":return t.stop()}}),t)}))),e.handleCopyID=function(e){navigator.clipboard.writeText(e),alert("ID copied: "+e)},e.switchRole=function(){var e=Object(i.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!=window.confirm("Confirm to switch the role of this staff? Your role will be switched to staff after this.")){e.next=6;break}return e.next=4,fetch("/change_staff_role",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sid:t})}).then((function(e){return e.text()})).then((function(e){"success"==e?(alert("Role has been changed"),window.location.href="/logout"):alert("Role failed to change")})).catch((function(e){alert("Error: "+e)}));case 4:e.next=7;break;case 6:return e.abrupt("return");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.deleteStaff=function(){var t=Object(i.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!=window.confirm("Confirm to delete this staff?")){t.next=6;break}return t.next=4,fetch("/delete_staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sid:a})}).then((function(e){return e.text()})).then((function(t){"success"==t?(alert("This staff has been deleted"),e.startup()):alert("Failed to delete this staff")})).catch((function(e){alert("Error: "+e)}));case 4:t.next=7;break;case 6:return t.abrupt("return");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.isDisable_switch=function(t){var a=e.state.staff_list,n=!1;return a.forEach((function(e){e._id==t&&"Admin"==e.role&&(n=!0)})),n},e.isDisable_delete=function(t){var a=e.state.staff_list,n=!1;return a.forEach((function(e){e._id==t&&"Admin"==e.role&&(n=!0)})),n},e.submitSearch=Object(i.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(a=e.state.search_query)){t.next=4;break}return e.startup(),t.abrupt("return");case 4:if(""!=a.trim()){t.next=7;break}return e.startup(),t.abrupt("return");case 7:return t.next=9,fetch("/search_staff_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search_query:a})}).then((function(e){return e.json()})).then((function(t){0==t?alert("No record found"):(t.forEach((function(e){e.hasOwnProperty("phone_no")||(e.phone_no="-"),1==e.role?e.role="Admin":0==e.role&&(e.role="Staff"),1==e.first_login?e.first_login="No":0==e.first_login&&(e.first_login="Yes"),e.date_created=e.date_created.replace("T"," ").substring(0,e.date_created.indexOf(".")-3)})),e.setState({staff_list:t}))})).catch((function(e){alert("Error: "+e)}));case 9:case"end":return t.stop()}}),t)}))),e.state={staff_list:null,search_query:null,verify_token:!1,verify_role:!1},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.startup()}},{key:"render",value:function(){var e=this,t=this.state,a=t.staff_list,n=t.verify_token,c=t.verify_role;return n&&c?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"Manage Staff")),r.a.createElement("div",{class:"page_content"},r.a.createElement("h2",null,"Manage Staff"),r.a.createElement("div",{class:"search_outer"},r.a.createElement("div",{class:"row"},r.a.createElement("input",{type:"text",class:"form-control col-sm-3",id:"search_query",name:"search_query",value:this.state.search_query,onChange:function(t){e.setState({search_query:t.target.value})},placeholder:"Search staff name / ID / email"}),r.a.createElement("button",{class:"btn btn-success col-sm-1 ml-2",onClick:function(){e.submitSearch()},type:"submit"},"Search"))),r.a.createElement("br",null),null==a?r.a.createElement("p",null,"Loading..."):r.a.createElement(y.a,{data:a,columns:[{Header:"ID",accessor:"_id",width:120,Cell:function(t){return r.a.createElement("div",{class:"table_column"},"..."+t.value.slice(t.value.length-4).toUpperCase()+" ",r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/60/60990.svg",width:17,title:"Copy full ID",class:"copy_id_icon",onClick:function(){e.handleCopyID(t.value)}}))}},{Header:"Name",accessor:"fname",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Email",accessor:"email",Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Phone No.",accessor:"phone_no",width:150,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Role",accessor:"role",width:120,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Activated",accessor:"first_login",width:120,Cell:function(e){return r.a.createElement("div",{class:"Yes"==e.value?"table_column_green":"table_column_red"},e.value)}},{Header:"Date Created",accessor:"date_created",width:160,Cell:function(e){return r.a.createElement("div",{class:"table_column"},e.value)}},{Header:"Switch Role",accessor:"_id",width:150,Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column_btn"},r.a.createElement("button",{class:"manage_btn register btn btn-success",onClick:function(){e.switchRole(a)},disabled:e.isDisable_switch(a)},"Switch Role"))}},{Header:"Delete",accessor:"_id",width:150,Cell:function(t){var a=t.value;return r.a.createElement("div",{class:"table_column_btn"},r.a.createElement("button",{class:"manage_btn register btn btn-danger",onClick:function(){e.deleteStaff(a)},disabled:e.isDisable_delete(a)},"Delete"))}}],defaultPageSize:10,className:"-striped -highlight"}))):r.a.createElement("div",null)}}]),a}(n.Component),re=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).verifyToken=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/get_own_profile_details",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){t.hasOwnProperty("phone_no")||(t.phone_no="-"),1==t.role?t.role="Admin":0==t.role&&(t.role="Staff"),1==t.first_login?t.first_login="No":0==t.first_login&&(t.first_login="Yes"),t.date_created=t.date_created.replace("T"," ").substring(0,t.date_created.indexOf(".")-3),e.setState({profile_details:t})})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.handleCopyID=function(e){navigator.clipboard.writeText(e),alert("ID copied: "+e)},e.updatePhoneNo=Object(i.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(a=e.state.updated_phone_no)){t.next=4;break}return alert("There is no update on the phone number"),t.abrupt("return");case 4:if(""!=(a=a.trim().replace(/\s/g,""))){t.next=10;break}return alert("Please enter your phone number"),t.abrupt("return");case 10:if(!/\D/.test(a)){t.next=15;break}return alert("Please enter number only"),t.abrupt("return");case 15:if("0"===a.substring(0,1)){t.next=20;break}return alert("Invalid phone number"),t.abrupt("return");case 20:if("04"!=a.substring(0,2)||!(a.length<9||a.length>10)){t.next=25;break}return alert("Invalid phone number"),t.abrupt("return");case 25:if("01"!=a.substring(0,2)||!(a.length<10||a.length>11)){t.next=30;break}return alert("Invalid phone number"),t.abrupt("return");case 30:if("01"===a.substring(0,2)||"04"===a.substring(0,2)){t.next=33;break}return alert("Invalid phone number"),t.abrupt("return");case 33:return t.next=35,fetch("/update_own_phone_number",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({updated_phone_no:a})}).then((function(e){return e.text()})).then((function(e){"success"==e?alert("Phone number updated successfully"):"failed"==e&&alert("Phone number existed in the other staff's record")})).catch((function(e){alert("Error: "+e)}));case 35:case"end":return t.stop()}}),t)}))),e.changePassword=Object(i.a)(l.a.mark((function t(){var a,n,r,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.state,n=a.current_psw,r=a.new_psw,c=a.con_new_psw,r===c){t.next=4;break}return alert("New password does not match"),t.abrupt("return");case 4:if(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z]{8,}$/.test(r)){t.next=7;break}return alert("New password must contain at least 8 characters with combination of number, uppercase and lowercase character"),t.abrupt("return");case 7:return t.next=9,fetch("/change_psw",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{current_psw:n,new_psw:r}})}).then((function(e){return e.json()})).then((function(e){e?(alert("Password changed successful"),window.location.href="/"):alert("Current password is incorrect or new password is same as current password")})).catch((function(e){alert("Error: "+e)}));case 9:case"end":return t.stop()}}),t)}))),e.verifyToken(),e.state={profile_details:null,updated_phone_no:null,current_psw:null,new_psw:null,con_new_psw:null,verify_token:!1},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.startup()}},{key:"render",value:function(){var e=this,t=this.state,a=t.profile_details,n=t.updated_phone_no,c=t.current_psw,o=t.new_psw,s=t.con_new_psw;return t.verify_token?r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"Manage Profile")),r.a.createElement("div",{class:"page_content"},r.a.createElement("h2",null,"Manage Profile"),r.a.createElement("br",null),null==a?r.a.createElement("p",null,"Loading..."):r.a.createElement("div",null,r.a.createElement("div",{class:"row mb-1"},r.a.createElement("h5",{class:"col-sm-2"},"ID"),r.a.createElement("p",{class:"lead col-sm-2 mt-n1"},a._id)),r.a.createElement("div",{class:"row mb-1"},r.a.createElement("h5",{class:"col-sm-2"},"Full Name"),r.a.createElement("p",{class:"lead col-sm-2 mt-n1"},a.fname)),r.a.createElement("div",{class:"row mb-1"},r.a.createElement("h5",{class:"col-sm-2"},"Email"),r.a.createElement("p",{class:"lead col-sm-2 mt-n1"},a.email)),r.a.createElement("div",{class:"row mb-3"},r.a.createElement("h5",{class:"col-sm-2"},"Phone No."),r.a.createElement("input",{placeholder:"Phone No.",type:"text",className:"form-control col-sm-2 mt-n2 ml-2",name:"phone_no",id:"phone_no",ref:"phone_no",maxLength:11,value:null==n?a.phone_no:n,onChange:function(t){e.setState({updated_phone_no:t.target.value})},required:!0}),r.a.createElement("button",{class:"btn btn-secondary col-sm-1 ml-2 mt-n2",onClick:function(){e.updatePhoneNo()},type:"submit"},"Update")),r.a.createElement("div",{class:"row mb-1"},r.a.createElement("h5",{class:"col-sm-2"},"Role"),r.a.createElement("p",{class:"lead col-sm-2 mt-n1"},a.role)),r.a.createElement("div",{class:"row mb-1"},r.a.createElement("h5",{class:"col-sm-2"},"Date Created"),r.a.createElement("p",{class:"lead col-sm-2 mt-n1"},a.date_created)),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement("br",null),r.a.createElement("h3",null,"Change Password"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{class:"row mb-4"},r.a.createElement("h5",{class:"col-sm-2"},"Current Password"),r.a.createElement("input",{placeholder:"Current Password",type:"password",className:"form-control col-sm-2 mt-n2 ml-2",name:"current_psw",id:"current_psw",ref:"current_psw",value:c,onChange:function(t){e.setState({current_psw:t.target.value})},required:!0})),r.a.createElement("div",{class:"row mb-4"},r.a.createElement("h5",{class:"col-sm-2"},"New Password"),r.a.createElement("input",{placeholder:"New Password",type:"password",className:"form-control col-sm-2 mt-n2 ml-2",name:"new_psw",id:"new_psw",ref:"new_psw",value:o,onChange:function(t){e.setState({new_psw:t.target.value})},required:!0})),r.a.createElement("div",{class:"row mb-4"},r.a.createElement("h5",{class:"col-sm-2"},"Confirm New Password"),r.a.createElement("input",{placeholder:"Confirm New Password",type:"password",className:"form-control col-sm-2 mt-n2 ml-2",name:"con_new_psw",id:"con_new_psw",ref:"con_new_psw",value:s,onChange:function(t){e.setState({con_new_psw:t.target.value})},required:!0})),r.a.createElement("br",null),r.a.createElement("button",{class:"btn btn-success col-sm-2",onClick:function(){e.changePassword()},type:"submit"},"Change Password")))):r.a.createElement("div",null)}}]),a}(n.Component),ce=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).logout=Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/logout",{method:"POST",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e?(alert("Logout successful"),window.location.href="/"):(alert("Logout failed"),window.location.href="/dashboard")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return e.stop()}}),e)}))),e.componentDidMount=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.logout();case 1:case"end":return t.stop()}}),t)}))),e.state={},e}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null)}}]),a}(n.Component),oe=a(62),se=function(e){Object(_.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).componentDidMount=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/get_hra_responses_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){e.setState({hra_responses_yes:t.yes,hra_responses_no:t.no})})).catch((function(e){alert("Error: "+e)}));case 2:return t.next=4,fetch("/get_hra_results_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){e.setState({hra_results:t})})).catch((function(e){alert("Error: "+e)}));case 4:return t.next=6,fetch("/get_hra_gender_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){e.setState({hra_gender:t})})).catch((function(e){alert("Error: "+e)}));case 6:return t.next=8,fetch("/get_hra_age_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.json()})).then((function(t){e.setState({hra_age:t})})).catch((function(e){alert("Error: "+e)}));case 8:case"end":return t.stop()}}),t)}))),e.startup=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.text()})).then((function(t){"failed"===t?(e.setState({verify_token:!1}),window.location.href="/"):"success"===t?e.setState({verify_token:!0}):"failed_first_login"===t&&(e.setState({verify_token:!1}),window.location.href="/change_password_first_login")})).catch((function(e){alert("Error: "+e)}));case 2:case"end":return t.stop()}}),t)}))),e.handleClose=function(){e.setState({modal_show:!1})},e.handleShow=function(t){e.setState({modal_show:!0}),e.view_casual_contacts(t)},e.handleSubmit=function(){var e=Object(i.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.startup(),e.state={hra_responses_yes:null,hra_responses_no:null,hra_results:null,hra_gender:null,hra_age:null,verify_token:!1},e}return Object(d.a)(a,[{key:"render",value:function(){var e,t,a,n,c=this.state,o=c.hra_age,s=c.hra_gender,l=c.hra_responses_yes,i=c.hra_responses_no,u=c.hra_results;return c.verify_token?(null!==s&&(e={labels:["Male","Female"],datasets:[{data:s,backgroundColor:["rgba(54, 162, 235, 0.5)","rgba(255, 99, 132, 0.5)"],hoverBackgroundColor:["rgba(54, 162, 235, 1)","rgba(255, 99, 132, 1)"]}]}),null!==o&&(t={labels:["0-14 years","15-24 years","25-64 years","65 years and above"],datasets:[{label:"Age Range",backgroundColor:"rgba(50, 88, 168,0.2)",borderColor:"rgba(50, 88, 168,1)",borderWidth:1,hoverBackgroundColor:"rgba(50, 88, 168,0.4)",hoverBorderColor:"rgba(50, 88, 168,1)",data:o}]}),null===l&&null===i||(a={labels:["Q1","Q2","Q3","Q4","Q5"],datasets:[{label:"Yes",backgroundColor:"rgba(155,231,91,0.2)",borderColor:"rgba(155,231,91,1)",borderWidth:1,hoverBackgroundColor:"rgba(155,231,91,0.4)",hoverBorderColor:"rgba(155,231,91,1)",data:l},{label:"No",backgroundColor:"rgba(255,99,132,0.2)",borderColor:"rgba(255,99,132,1)",borderWidth:1,hoverBackgroundColor:"rgba(255,99,132,0.4)",hoverBorderColor:"rgba(255,99,132,1)",data:i}]}),null!==u&&(n={labels:["Health Check Recommended for COVID-19","No Health Check Recommended for COVID-19"],datasets:[{data:u,backgroundColor:["rgba(255,99,132, 0.5)","rgba(161, 237, 172, 0.5)"],hoverBackgroundColor:["rgba(255,99,132, 1)","rgba(161, 237, 172, 1)"]}]}),r.a.createElement("div",{class:""},r.a.createElement(v,null),r.a.createElement("div",{class:"page_header"},r.a.createElement("div",{class:"page_title"},"Health Risk Assessment Analytics")),r.a.createElement("div",{class:"page_content"},null==s||null==o||null==l||null==i||null==u?r.a.createElement("p",null,"Loading..."):r.a.createElement("div",null,r.a.createElement("h4",{class:"font-weight-bold mb-3"},"Respondent Demographic Overview"),r.a.createElement("br",null),r.a.createElement("h5",null,"Total number of respondent: "+parseInt(s[0]+s[1])),r.a.createElement("div",{class:"row px-3"},r.a.createElement("div",{class:"col-sm-6"},r.a.createElement(oe.Pie,{width:500,height:300,data:e})),r.a.createElement("div",{class:"col-sm-6"},r.a.createElement(oe.Bar,{width:500,height:300,data:t,options:{scales:{yAxes:[{ticks:{beginAtZero:!0,precision:0}}]}}}))),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement("br",null),r.a.createElement("h4",{class:"font-weight-bold mb-3"},"Responses Overview"),r.a.createElement("div",{class:"hra_questions"},r.a.createElement("p",{class:"lead"},"Q1. Have you / your dependent traveled to (or living in) any of the ",r.a.createElement("b",null,"COVID-19 affected areas/countries")," in the last 14 days?"),r.a.createElement("p",{class:"lead"},"Q2. Have you / your dependent had any ",r.a.createElement("b",null,"close contact")," ","with a person who is known to have COVID-19 during the last 14 days?"),r.a.createElement("p",{class:"lead"},"Q3. Do you / your dependent have a ",r.a.createElement("b",null,"fever"),"?"),r.a.createElement("p",{class:"lead"},"Q4. Do you / your dependent have a ",r.a.createElement("b",null,"cough"),"?"),r.a.createElement("p",{class:"lead"},"Q5. Do you / your dependent have a ",r.a.createElement("b",null,"shortness of breath"),"?")),r.a.createElement("div",{class:"col-sm-8"},r.a.createElement(oe.Bar,{width:500,height:300,data:a,options:{scales:{yAxes:[{ticks:{beginAtZero:!0,precision:0}}]}}})),r.a.createElement("br",null),r.a.createElement("hr",null),r.a.createElement("br",null),r.a.createElement("h4",{class:"font-weight-bold mb-3"},"Results Overview"),r.a.createElement("br",null),r.a.createElement("div",{class:"col-sm-6"},r.a.createElement(oe.Pie,{width:500,height:300,data:n})),r.a.createElement("br",null),r.a.createElement("br",null))))):r.a.createElement("div",null)}}]),a}(n.Component),le=function(){return r.a.createElement(f.a,null,r.a.createElement(E.c,null,r.a.createElement(E.a,{path:"/",component:b,exact:!0}),r.a.createElement(E.a,{path:"/change_password_first_login",component:g,exact:!0}),r.a.createElement(E.a,{path:"/dashboard",component:w,exact:!0}),r.a.createElement(E.a,{path:"/search_casual_contacts",component:S,exact:!0}),r.a.createElement(E.a,{path:"/view_casual_contacts",component:O,exact:!0}),r.a.createElement(E.a,{path:"/view_confirmed_case_check_ins/:group_record_id",component:A}),r.a.createElement(E.a,{path:"/view_casual_contact_check_ins/:check_in_id/:check_in_group_id",component:P}),r.a.createElement(E.a,{path:"/view_simp_casual_contact_check_ins/:group_record_id",component:D}),r.a.createElement(E.a,{path:"/download_excel_casual_contacts/:check_in_id/:check_in_group_id",component:J}),r.a.createElement(E.a,{path:"/download_excel_infected_premise/:check_in_group_id",component:M}),r.a.createElement(E.a,{path:"/add_hotspot",component:V}),r.a.createElement(E.a,{path:"/view_hotspots",component:z}),r.a.createElement(E.a,{path:"/view_hotspots_each/:group_record_id",component:W}),r.a.createElement(E.a,{path:"/view_hotspots_manual_add",component:ee}),r.a.createElement(E.a,{path:"/send_batch_email",component:te,exact:!0}),r.a.createElement(E.a,{path:"/health_risk_assessment_analytics",component:se,exact:!0}),r.a.createElement(E.a,{path:"/add_staff",component:ae,exact:!0}),r.a.createElement(E.a,{path:"/manage_staff",component:ne,exact:!0}),r.a.createElement(E.a,{path:"/manage_profile",component:re,exact:!0}),r.a.createElement(E.a,{path:"/NavBar",component:v,exact:!0}),r.a.createElement(E.a,{path:"/logout",component:ce,exact:!0}),r.a.createElement(E.a,{path:"*",component:b})))};o.a.render(r.a.createElement(le,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},75:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAADdAAAA3QFwU6IHAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAZ5QTFRF/////wAA/wAA/4CA/1VV/0BA/1VV30BA/05O/1BQ/1lN9UdH/1VV70JC/1VV8kpD/1dR/1dR/1VP7UlJ/1VR/1ZS7EVI/1hU7UlF/1dQ/1hS7EZG7EhE/1ZT/1ZT60dE/1dS/1dT6kZG/1dT60ZG/1hR60VF/1ZS6UZG/1dR/1ZS6UZG/1ZT/1dR6EVF/1dS6ERE6UVF/1dT6EVD/1dS/1dS6UVD/1ZS/1dS50ND50ND5kND/1dR/1dS50ND5kRC/1dS5UJC/1dS/1dS5EFB/1ZS40FB/1ZS5EFB40BB/1hS4kFB4kBA4j9B/1dR/1dS/1dS4D4//1dS/1dS3j0+4D0+3z0+3jw9/1dS3Ts93Tw9xdjfxtjfyNnfydjfytjezNbbzdXb0cvP0sbL0sfL1qyw16Kl2JKU2YeL2l9i2mdq2m1v2m5w2zo82zw+20FD20xO205R3Ds83Ds97+vr7+/v8OXl8d3d8d/e8s/O8tHQ9bWz9bu5+JqX+ZKP+oaD+4B8/HBs/HFs/Wlk/W1p/l9b/mFc/1dS/1hT/1pVqptFDAAAAFt0Uk5TAAECAgMEBggNEBQZHh8kJiYsLTg5PkNDRklLUFJTX2VqbG1vdHd9f4CBgouLjZubqKqqrq+ytrq7v8HCwsTKzNbY3uDj4+bm6Ozs7fDx8fT1+Pn6+/v8/f3+/nKHsyQAAAFXSURBVDhPfdNlU8NAFIXhW6BQiru7u7u7uxOsuC1SCNLiFvjXNDfJSho4X99ndiabWQA2Z2pRw9DScEtxFFjNlj2l+EZ8u6oO8O/hzYpiAELG4sw9YVLhAVnJFbujTxEBWQgTQJWevz+Oz3TRw/cULX95b2RpfedSE4Uc6MD+eifLsiRJGycIJlgPmlb7j0fWgLR1jh8bTEEMHvAkG0DaxyPSKMhE4GVgF0ElBeUI7hlwIeikoADBAwPbCBopyEDwyMAegjIKYhF83hpg8wJBOgW2XhQv1xpYO8Q+z/3SUu0m3zwqcJ1qN9nGOkQr+t6fD46IvmQOQL0h6N8kg3yHyFkzcCcKACrMoEvsEDoqgtUIE4AcEdSYO9i7eTAT4gcgaZkD+f4doISBVqsOgU0GGLFbAnAOaGDR+un5Fj+nAnfWXx0gTwV1f3eAWoX0/9fB0T4uPjn4BbiY44IDk6OhAAAAAElFTkSuQmCC"}},[[206,1,2]]]);
//# sourceMappingURL=main.fb863107.chunk.js.map